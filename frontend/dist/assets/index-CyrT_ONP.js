import{ad as nt,ae as e,r,af as te,ag as ot,ah as at,ai as st,aj as We,ak as _,al as it,am as rt,an as lt,ao as dt,ap as Le,aq as Me,ar as ct,as as pt,at as xt,au as ut,av as gt,aw as ft,ax as ht,ay as mt,az as yt,aA as ce,aB as pe,aC as Re,aD as bt,aE as jt,aF as Ce,aG as ke,aH as vt,aI as wt,aJ as ee,aK as St,R as Ct,aL as kt}from"./vendor-BK-HHdZY.js";import{R as se,B as Ie,C as ge,X as fe,Y as he,T as ie,a as Te,P as Ue,b as He,c as qe,L as It,d as Tt}from"./recharts-CLWUXVxd.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))n(d);new MutationObserver(d=>{for(const p of d)if(p.type==="childList")for(const w of p.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&n(w)}).observe(document,{childList:!0,subtree:!0});function i(d){const p={};return d.integrity&&(p.integrity=d.integrity),d.referrerPolicy&&(p.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?p.credentials="include":d.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function n(d){if(d.ep)return;d.ep=!0;const p=i(d);fetch(d.href,p)}})();const zt="/api",k=nt.create({baseURL:zt,headers:{"Content-Type":"application/json"}});k.interceptors.request.use(o=>{const s=localStorage.getItem("token");return s&&(o.headers.Authorization=`Bearer ${s}`),o});k.interceptors.response.use(o=>o,o=>{var i;const s=(i=o.response)==null?void 0:i.status;if(s===401||s===403){localStorage.removeItem("token"),localStorage.removeItem("user");const n=window.location.pathname;n.startsWith("/admin")?n!=="/admin/login"&&(window.location.href="/admin/login"):n.startsWith("/staff")&&n!=="/staff/login"&&(window.location.href="/staff/login")}return Promise.reject(o)});const De="queueEntry",Be="queueDate",Ve=o=>{const s=new Date().toISOString().split("T")[0];localStorage.setItem(De,JSON.stringify(o)),localStorage.setItem(Be,s)},me=()=>{const o=localStorage.getItem(De),s=localStorage.getItem(Be),i=new Date().toISOString().split("T")[0];if(!o||s!==i)return s!==i&&xe(),null;try{return JSON.parse(o)}catch{return xe(),null}},xe=()=>{localStorage.removeItem(De),localStorage.removeItem(Be)};function J({label:o,error:s,...i}){return e.jsxs("div",{style:{marginBottom:"16px"},children:[o&&e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500",color:"#1e293b"},children:o}),e.jsx("input",{style:{width:"100%",padding:"12px",borderRadius:"8px",border:s?"2px solid #ef4444":"2px solid #e2e8f0",fontSize:"16px",transition:"border-color 0.2s"},...i}),s&&e.jsx("div",{style:{marginTop:"4px",fontSize:"12px",color:"#ef4444"},children:s})]})}function E({children:o,onClick:s,variant:i="primary",disabled:n=!1,fullWidth:d=!1,icon:p,iconPosition:w="left",type:h,style:c,...f}){const g={padding:"10px 20px",borderRadius:"8px",border:"none",fontSize:"14px",fontWeight:"600",cursor:n?"not-allowed":"pointer",transition:"all 0.2s",opacity:n?.6:1,width:d?"100%":"auto",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",boxShadow:i==="primary"||i==="success"||i==="danger"||i==="gradient"?"0 2px 4px rgba(0,0,0,0.1)":"none",...c},l={primary:{background:n?"#cbd5e1":"#2563eb",color:"white"},gradient:{background:n?"#cbd5e1":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",boxShadow:n?"none":"0 4px 12px rgba(102, 126, 234, 0.4)"},secondary:{background:n?"#cbd5e1":"#64748b",color:"white"},success:{background:n?"#cbd5e1":"#10b981",color:"white"},danger:{background:n?"#cbd5e1":"#ef4444",color:"white"},outline:{background:"transparent",color:n?"#cbd5e1":"#2563eb",border:`2px solid ${n?"#cbd5e1":"#2563eb"}`}},b=l[i]||l.primary,v=p&&e.jsx(p,{size:18,strokeWidth:2.5}),C=w==="left"?e.jsxs(e.Fragment,{children:[" ",v," ",o," "]}):e.jsxs(e.Fragment,{children:[" ",o," ",v," "]});return e.jsx("button",{type:h||"button",style:{...g,...b},onClick:n?void 0:s,disabled:n,onMouseOver:a=>{n||(i==="primary"?(a.target.style.background="#1e40af",a.target.style.boxShadow="0 4px 8px rgba(37, 99, 235, 0.3)"):i==="outline"?a.target.style.background="#eff6ff":i==="danger"?(a.target.style.background="#dc2626",a.target.style.boxShadow="0 4px 8px rgba(239, 68, 68, 0.3)"):i==="success"?(a.target.style.background="#059669",a.target.style.boxShadow="0 4px 8px rgba(16, 185, 129, 0.3)"):i==="gradient"&&(a.target.style.background="linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%)",a.target.style.boxShadow="0 6px 16px rgba(102, 126, 234, 0.5)"))},onMouseOut:a=>{n||(a.target.style.background=b.background,a.target.style.boxShadow=i==="gradient"?"0 4px 12px rgba(102, 126, 234, 0.4)":i==="primary"||i==="success"||i==="danger"?"0 2px 4px rgba(0,0,0,0.1)":"none")},...f,children:C})}function ne(){return e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px"},children:[e.jsx("div",{style:{width:"40px",height:"40px",border:"4px solid #e2e8f0",borderTop:"4px solid #2563eb",borderRadius:"50%",animation:"spin 1s linear infinite"}}),e.jsx("style",{children:`
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
      `})]})}function oe({size:o="medium",showText:s=!0}){const[i,n]=r.useState(null),[d,p]=r.useState(!0),[w,h]=r.useState(!1);r.useEffect(()=>{c();const l=setInterval(c,3e4);return()=>clearInterval(l)},[]);const c=async()=>{try{const l=await k.get("/admin/settings/logo");if(l.data.logoUrl){let b=l.data.logoUrl;b&&!b.startsWith("http")&&!b.startsWith("/")&&(b="/"+b);const v=b.includes("?")?"&":"?";b=b+v+"_t="+Date.now(),n(b),h(!1)}else n(null),h(!1)}catch(l){console.error("Failed to load logo:",l),h(!0)}finally{p(!1)}},f={small:{width:"80px",height:"40px"},medium:{width:"120px",height:"60px"},large:{width:"180px",height:"90px"}},g=f[o]||f.medium;return d?null:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[i&&!w?e.jsx("img",{src:i,alt:"Logo",style:{...g,objectFit:"contain",maxWidth:"100%"},onError:l=>{console.error("Failed to load logo image:",i),h(!0),n(null)}}):e.jsx("div",{style:{...g,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"8px",color:"white",fontWeight:"700",fontSize:o==="small"?"14px":o==="large"?"24px":"18px"},children:"Q"}),s&&e.jsx("span",{style:{fontSize:o==="small"?"18px":o==="large"?"28px":"24px",fontWeight:"700",color:"#1e293b"}})]})}const Wt=[{value:"REGULAR",label:"Regular"},{value:"SENIOR_CITIZEN",label:"Senior Citizen"},{value:"PWD",label:"PWD"},{value:"PREGNANT",label:"Pregnant"}];function Rt(){const o=te(),[s,i]=r.useState(!0),[n,d]=r.useState(!1),[p,w]=r.useState([]),[h,c]=r.useState({clientName:"",clientType:"REGULAR",categoryIds:[],subCategoryIds:[]}),[f,g]=r.useState({});r.useEffect(()=>{l()},[]);const l=async()=>{var x;try{const m=await k.get("/categories");w(Array.isArray((x=m.data)==null?void 0:x.categories)?m.data.categories:[])}catch(m){console.error("Failed to load categories:",m)}finally{i(!1)}},b=r.useMemo(()=>{var j;if(!((j=h.categoryIds)!=null&&j.length))return[];const x=(p||[]).filter(A=>h.categoryIds.includes(A.id)),m=new Map;return x.forEach(A=>{(A.subCategories||[]).forEach(U=>{m.has(U.id)||m.set(U.id,{...U,categoryName:A.name})})}),Array.from(m.values())},[h.categoryIds,p]),v=x=>{const m=h.categoryIds||[],j=m.includes(x)?m.filter(H=>H!==x):[...m,x],A=(p||[]).filter(H=>j.includes(H.id)),U=new Set;A.forEach(H=>{(H.subCategories||[]).forEach(V=>U.add(V.id))}),c({...h,categoryIds:j,subCategoryIds:(h.subCategoryIds||[]).filter(H=>U.has(H))})},C=x=>{const m=h.subCategoryIds||[],j=m.includes(x)?m.filter(A=>A!==x):[...m,x];c({...h,subCategoryIds:j})},a=async x=>{var j,A,U,H;x.preventDefault(),g({});const m={};if(h.clientName.trim()||(m.clientName="Name is required"),(j=h.categoryIds)!=null&&j.length||(m.categoryId="Select at least one category"),Object.keys(m).length>0){g(m);return}d(!0);try{const T=(await k.post("/queue/join",{clientName:h.clientName.trim(),clientType:h.clientType,categoryIds:h.categoryIds,subCategoryIds:(A=h.subCategoryIds)!=null&&A.length?h.subCategoryIds:void 0})).data.queueEntry,D=(T.concernCategories||[T.category]).map(M=>M.name).join(", "),q=(T.concernSubCategories||[]).map(M=>M.name).join(", ")||null;Ve({queueNumber:T.queueNumber,clientName:T.clientName,date:T.date,category:D,subCategory:q,clientType:T.clientType,status:T.status}),o("/success")}catch(V){console.error("Failed to join queue:",V),g({submit:((H=(U=V.response)==null?void 0:U.data)==null?void 0:H.error)||"Failed to join queue"})}finally{d(!1)}};return s?e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ne,{})}):e.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"32px",maxWidth:"500px",width:"100%",boxShadow:"0 20px 60px rgba(0,0,0,0.3)"},children:[e.jsx("div",{style:{marginBottom:"24px",display:"flex",justifyContent:"center"},children:e.jsx(oe,{size:"medium"})}),e.jsx("h1",{style:{fontSize:"28px",fontWeight:"700",marginBottom:"8px",color:"#1e293b",textAlign:"center"},children:"Join Queue"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",textAlign:"center",marginBottom:"32px"},children:"Fill in your details to get a queue number"}),e.jsxs("form",{onSubmit:a,children:[e.jsx(J,{label:"Your Name",value:h.clientName,onChange:x=>c({...h,clientName:x.target.value}),error:f.clientName,placeholder:"Enter your full name",required:!0}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"10px",color:"#1e293b"},children:"Client Type"}),e.jsx("div",{className:"client-type-pills",children:Wt.map(({value:x,label:m})=>e.jsxs("label",{className:`pill-radio ${h.clientType===x?"selected":""}`,children:[e.jsx("input",{type:"radio",name:"clientType",value:x,checked:h.clientType===x,onChange:()=>c({...h,clientType:x})}),e.jsx("span",{children:m})]},x))})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsxs("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"10px",color:"#1e293b"},children:["Concern Category ",e.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),f.categoryId&&e.jsx("div",{style:{fontSize:"12px",color:"#ef4444",marginBottom:"8px"},children:f.categoryId}),e.jsx("div",{className:"checkbox-group",children:(p||[]).map(x=>e.jsxs("label",{className:`checkbox-row ${(h.categoryIds||[]).includes(x.id)?"selected":""}`,children:[e.jsx("input",{type:"checkbox",checked:(h.categoryIds||[]).includes(x.id),onChange:()=>v(x.id)}),e.jsx("span",{className:"checkmark"}),e.jsx("span",{children:x.name})]},x.id))})]}),b.length>0&&e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"10px",color:"#1e293b"},children:"Sub-Concern (Optional)"}),e.jsx("div",{className:"checkbox-group",children:b.map(x=>e.jsxs("label",{className:`checkbox-row ${(h.subCategoryIds||[]).includes(x.id)?"selected":""}`,children:[e.jsx("input",{type:"checkbox",checked:(h.subCategoryIds||[]).includes(x.id),onChange:()=>C(x.id)}),e.jsx("span",{className:"checkmark"}),e.jsx("span",{children:x.name})]},x.id))})]}),f.submit&&e.jsx("div",{style:{padding:"12px",background:"#fee2e2",color:"#991b1b",borderRadius:"8px",marginBottom:"16px",fontSize:"14px"},children:f.submit}),e.jsx(E,{type:"submit",variant:"gradient",fullWidth:!0,disabled:n,style:{marginTop:"8px",padding:"14px 24px",fontSize:"16px"},children:n?"Joining...":"Join Queue"})]}),e.jsx("div",{style:{marginTop:"24px",textAlign:"center"},children:e.jsx("a",{href:"/monitor",style:{color:"#2563eb",textDecoration:"none",fontSize:"14px"},children:"View Queue Status â†’"})})]})})}function ye(o){if(!o)return"";const s=o.split("-");return s.length>1?s[1]:o}function Dt(o){return o?o.split("_").map(s=>s.charAt(0).toUpperCase()+s.slice(1).toLowerCase()).join(" "):""}function $e({window:o}){const{label:s,staff:i,currentServing:n}=o,d=c=>{const f=c.trim().split(" ");return f.length>=2?(f[0][0]+f[f.length-1][0]).toUpperCase():c.substring(0,2).toUpperCase()},p=(i==null?void 0:i.name)||"â€”",w=n?ye(n.queueNumber):null,h=n&&[n.clientName||"",n.clientType?`(${Dt(n.clientType)})`:""].filter(Boolean).join(" ").trim()||null;return e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",border:"2px solid #e2e8f0",transition:"all 0.2s",display:"flex",alignItems:"stretch",gap:"20px",minHeight:"180px"},children:[e.jsx("div",{style:{flex:"0 0 38%",maxWidth:"200px",borderRadius:"12px",overflow:"hidden",background:i!=null&&i.profilePicture?void 0:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center"},children:i!=null&&i.profilePicture?e.jsx("img",{src:i.profilePicture,alt:p,style:{width:"100%",height:"100%",objectFit:"cover",display:"block"}}):e.jsx("span",{style:{color:"white",fontWeight:"700",fontSize:"32px"},children:d(p)})}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",minWidth:0},children:[e.jsx("div",{style:{fontSize:"26px",fontWeight:"700",color:"#1e293b",marginBottom:"4px"},children:p}),n?e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{fontSize:"22px",fontWeight:"700",color:"#1e293b",marginBottom:"8px"},children:"is now serving:"}),e.jsx("div",{style:{fontSize:"clamp(48px, 8vw, 84px)",fontWeight:"700",color:"#1e293b",lineHeight:1.1,marginBottom:"8px"},children:w}),h&&e.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#475569",marginBottom:"8px"},children:h})]}):e.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#94a3b8",fontStyle:"italic"},children:"No active service"}),e.jsx("div",{style:{marginTop:"auto",paddingTop:"12px",fontSize:"32px",fontWeight:"700",color:"#1e293b"},children:s})]})]})}function Ge({clientType:o}){const s={REGULAR:{bg:"#e2e8f0",color:"#475569"},SENIOR_CITIZEN:{bg:"#fef3c7",color:"#92400e"},PWD:{bg:"#dbeafe",color:"#1e40af"},PREGNANT:{bg:"#fce7f3",color:"#9f1239"}},i={REGULAR:"Regular",SENIOR_CITIZEN:"Senior",PWD:"PWD",PREGNANT:"Pregnant"},n=s[o]||s.REGULAR;return e.jsx("span",{style:{display:"inline-block",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",backgroundColor:n.bg,color:n.color},children:i[o]})}function Bt(){const o=te(),[s,i]=r.useState(null),[n,d]=r.useState([]),[p,w]=r.useState(!0),[h,c]=r.useState(0);r.useEffect(()=>{const b=me();if(!b){o("/");return}i(b),f();const v=setInterval(f,2e3);return()=>clearInterval(v)},[o]),r.useEffect(()=>{(s==null?void 0:s.status)==="SERVED"&&o("/thank-you")},[s==null?void 0:s.status,o]);const f=async()=>{var b;try{const v=me()||s;if(v!=null&&v.queueNumber){const x=(await k.get(`/queue/${v.queueNumber}`)).data.queueEntry,m={...v,status:x.status};if(i(m),Ve(m),x.status==="SERVED"){o("/thank-you");return}if(x.status==="WAITING")try{const j=await k.get(`/queue/${v.queueNumber}/ahead`);c(j.data.peopleAhead||0)}catch{const A=await k.get("/queue/public/stats");c(A.data.waiting||0)}else c(0)}const C=await k.get("/queue/public/windows");d(C.data.windows)}catch(v){console.error("Failed to load data:",v),((b=v.response)==null?void 0:b.status)===404&&(xe(),o("/"))}finally{w(!1)}};if(p||!s)return e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ne,{})});const g={WAITING:{bg:"#fef3c7",color:"#92400e",text:"Waiting"},NOW_SERVING:{bg:"#dbeafe",color:"#1e40af",text:"Being served"},SERVED:{bg:"#d1fae5",color:"#065f46",text:"Served"},SKIPPED:{bg:"#fee2e2",color:"#991b1b",text:"Skipped"}},l=g[s.status]||g.WAITING;return e.jsx("div",{style:{minHeight:"100vh",background:"#f8fafc",padding:"20px"},children:e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[e.jsx("div",{style:{marginBottom:"24px",display:"flex",justifyContent:"center"},children:e.jsx(oe,{size:"medium"})}),e.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"32px",marginBottom:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"14px",color:"#64748b",marginBottom:"8px"},children:["Hello, ",s.clientName]}),e.jsx("div",{style:{fontSize:"48px",fontWeight:"700",color:"#2563eb",marginBottom:"16px",letterSpacing:"2px"},children:ye(s.queueNumber)}),e.jsx("div",{style:{display:"inline-block",padding:"8px 16px",borderRadius:"20px",backgroundColor:l.bg,color:l.color,fontSize:"14px",fontWeight:"600",marginBottom:"16px"},children:l.text}),e.jsxs("div",{style:{marginTop:"16px",display:"flex",gap:"12px",justifyContent:"center",flexWrap:"wrap"},children:[e.jsx(Ge,{clientType:s.clientType}),e.jsxs("span",{style:{padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",backgroundColor:"#e2e8f0",color:"#475569"},children:[s.category,s.subCategory&&` - ${s.subCategory}`]})]}),s.status==="WAITING"&&h>0&&e.jsxs("div",{style:{marginTop:"16px",fontSize:"14px",color:"#64748b"},children:["Approximately ",h," ",h===1?"person":"people"," ahead"]}),e.jsx("div",{style:{marginTop:"24px",padding:"16px",background:"#f1f5f9",borderRadius:"8px",fontSize:"14px",color:"#475569"},children:"ðŸ’¡ You can leave and monitor your queue status from this page. We'll update automatically."})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"16px",color:"#1e293b"},children:"Active Windows"}),e.jsx("div",{className:"grid-responsive",style:{display:"grid",gap:"16px"},children:n.length>0?n.map(b=>e.jsx($e,{window:b},b.id)):e.jsx("div",{style:{gridColumn:"1 / -1",textAlign:"center",padding:"40px",background:"white",borderRadius:"12px",color:"#64748b"},children:"No active windows at the moment"})})]})]})})}function At(){const o=te();r.useEffect(()=>{const i=me();if(!i||i.status!=="SERVED"){o("/");return}const n=setTimeout(()=>{xe()},5e3);return()=>clearTimeout(n)},[o]);const s=me();return e.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:e.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"48px",maxWidth:"600px",width:"100%",boxShadow:"0 20px 60px rgba(0,0,0,0.3)",textAlign:"center"},children:[e.jsx("div",{style:{marginBottom:"24px",display:"flex",justifyContent:"center"},children:e.jsx(oe,{size:"medium"})}),e.jsx("div",{style:{fontSize:"64px",marginBottom:"24px"},children:"âœ…"}),e.jsx("h1",{style:{fontSize:"32px",fontWeight:"700",marginBottom:"16px",color:"#1e293b"},children:"Thank You!"}),s&&e.jsxs("p",{style:{fontSize:"18px",color:"#64748b",marginBottom:"24px"},children:["Thank you, ",e.jsx("strong",{children:s.clientName}),", for your visit."]}),e.jsx("p",{style:{fontSize:"16px",color:"#475569",marginBottom:"32px",lineHeight:"1.6"},children:"We appreciate your business and look forward to serving you again."}),e.jsx("div",{style:{padding:"20px",background:"#f1f5f9",borderRadius:"12px",marginBottom:"32px"},children:e.jsx("p",{style:{fontSize:"14px",color:"#64748b",margin:0},children:"Your service has been completed. Have a wonderful day!"})}),e.jsx("button",{onClick:()=>{xe(),o("/")},style:{padding:"12px 32px",borderRadius:"8px",border:"none",background:"#2563eb",color:"white",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},onMouseOver:i=>{i.target.style.background="#1e40af"},onMouseOut:i=>{i.target.style.background="#2563eb"},children:"Return to Home"})]})})}function Pt(){const[o,s]=r.useState([]),[i,n]=r.useState([]),[d,p]=r.useState(null),[w,h]=r.useState(!0),[c,f]=r.useState(!1),g=r.useRef(null),l=r.useRef([]),b=r.useRef(!1),v=r.useRef([]),C=r.useRef(!1),[a,x]=r.useState(null),[m,j]=r.useState("");r.useEffect(()=>{A(),U(),H();const t=setInterval(A,2e3);return()=>clearInterval(t)},[]),r.useEffect(()=>{S()},[]),r.useEffect(()=>{i.length>0&&!d&&p(i[0])},[i,d]),r.useEffect(()=>{if(g.current&&d){const t=g.current,u=()=>{const B=(i.findIndex(O=>O.url===d.url)+1)%i.length;p(i[B])};t.addEventListener("ended",u),t.volume=1,t.load();const I=t.play();return I!==void 0&&I.then(()=>{t.muted=!1}).catch(()=>{t.muted=!0,t.play().catch(console.error)}),()=>{t.removeEventListener("ended",u)}}},[d,i]);const A=async()=>{try{const u=(await k.get("/queue/public/windows")).data.windows||[];try{K(l.current,u)}catch(I){console.error("Failed to run TTS announcements:",I)}s(u),l.current=u}catch(t){console.error("Failed to load windows:",t)}finally{h(!1)}},U=async()=>{try{const t=await k.get("/admin/settings/ding-sound");x(t.data.dingSoundUrl||null)}catch(t){console.error("Failed to load ding sound URL:",t),x(null)}},H=async()=>{try{const t=await k.get("/admin/settings/tts-announcement");t.data.template&&j(t.data.template)}catch(t){console.error("Failed to load TTS announcement template:",t)}},V=t=>{if(typeof window>"u"){t&&setTimeout(t,7e3);return}let I=!1;const z=()=>{I||(I=!0,t&&t())};try{if(a){const O=new Audio(a);O.volume=1,O.addEventListener("ended",z),O.addEventListener("error",$=>{console.error("Failed to play custom ding sound:",$),z()}),O.play().catch($=>{console.error("Failed to start custom ding sound:",$),z()}),setTimeout(z,7e3);return}const B=window.AudioContext||window.webkitAudioContext;if(B){const O=new B,$=O.createOscillator(),R=O.createOscillator(),Y=O.createGain();$.type="sine",R.type="sine";const L=O.currentTime;$.frequency.setValueAtTime(880,L),R.frequency.setValueAtTime(1175,L+.08),$.connect(Y),R.connect(Y),Y.connect(O.destination),Y.gain.setValueAtTime(1e-4,L),Y.gain.exponentialRampToValueAtTime(.25,L+.03),Y.gain.exponentialRampToValueAtTime(1e-4,L+.4),$.start(L),R.start(L+.08),$.stop(L+.4),R.stop(L+.4),setTimeout(z,500);return}}catch(B){console.error("Failed to play ding sound:",B)}setTimeout(z,7e3)},T=t=>{const u=g.current;u&&(u.volume=Math.max(0,Math.min(1,t)))},D=t=>new Promise(u=>{k.post("/tts",{text:t},{responseType:"arraybuffer"}).then(I=>{const z=I.data;if(!z){u();return}const B=new Blob([z],{type:"audio/mpeg"}),O=URL.createObjectURL(B),$=new Audio(O);$.addEventListener("ended",()=>{URL.revokeObjectURL(O),u()}),$.addEventListener("error",()=>{URL.revokeObjectURL(O),u()}),$.play().catch(()=>u())}).catch(()=>{if(typeof window<"u"&&window.speechSynthesis){const I=new SpeechSynthesisUtterance(t);I.lang="en-US",I.rate=1,I.pitch=1,I.onend=u,I.onerror=u,window.speechSynthesis.cancel(),window.speechSynthesis.speak(I)}else u()})}),q=()=>new Promise(t=>V(t)),M=async()=>{if(C.current||v.current.length===0)return;C.current=!0;const{text:t}=v.current.shift();T(.5),await q(),await D(t),T(1),C.current=!1,v.current.length>0&&M()},K=(t,u)=>{if(typeof window>"u")return;if(!b.current){b.current=!0;return}const I=new Map;(t||[]).forEach(B=>{B&&B.id&&B.currentServing&&I.set(B.id,B.currentServing.queueNumber)});const z=[];(u||[]).forEach(B=>{if(!B||!B.id||!B.currentServing)return;const O=B.currentServing.queueNumber,$=B.currentServing.clientName,R=I.get(B.id);if(!O||O===R)return;const Y=ye?ye(O):O;let L=Y;const X=parseInt(Y,10);Number.isNaN(X)||(L=String(X));const je=B.label||"Window",ve=$?`, or client name ${$}`:"",we=(m||"Window {{window}} will now serve queue number {{queueNumber}}{{clientNamePart}}.").replace(/{{\s*(window|window number)\s*}}/gi,je).replace(/{{\s*(queueNumber|queue number)\s*}}/gi,L).replace(/{{\s*clientNamePart\s*}}/gi,ve).replace(/{{\s*(clientName|client name)\s*}}/gi,$||"");z.push({text:we})}),z.forEach(B=>v.current.push(B)),M()},S=async()=>{try{const t=await k.get("/videos");n(t.data.videos||[]),f(!1)}catch(t){console.error("Failed to load videos:",t),f(!0),n([])}};return e.jsxs("div",{style:{height:"100vh",display:"flex",flexDirection:"column",background:"#f8fafc",overflow:"hidden"},children:[e.jsx("div",{style:{flex:"0 0 50vh",minHeight:0,overflowY:"auto"},children:e.jsxs("div",{style:{padding:"20px",maxWidth:"1400px",margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",padding:"8px 0"},children:[e.jsx(oe,{size:"large"}),e.jsx("h1",{style:{fontSize:"28px",fontWeight:"700",color:"#1e293b",margin:0},children:"Queue Monitoring"})]}),w?e.jsx(ne,{}):e.jsx("div",{style:{display:"grid",gap:"16px",marginBottom:"24px"},className:"grid-responsive",children:o.length>0?o.map(t=>e.jsx($e,{window:t},t.id)):e.jsx("div",{style:{gridColumn:"1 / -1",textAlign:"center",padding:"40px",background:"white",borderRadius:"12px",color:"#64748b"},children:"No active windows at the moment"})})]})}),e.jsx("div",{style:{flex:"0 0 50vh",minHeight:0,background:"#1e293b",display:"flex",flexDirection:"column"},children:i.length>0&&!c?e.jsx("div",{style:{flex:1,minHeight:0,position:"relative",background:"#000"},children:e.jsx("video",{ref:g,src:d==null?void 0:d.url,controls:!0,autoPlay:!0,muted:!0,playsInline:!0,style:{width:"100%",height:"100%",objectFit:"contain"}})}):e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px 40px",textAlign:"center"},children:[e.jsx("div",{style:{color:"#94a3b8",fontSize:"18px",fontWeight:"500",marginBottom:"8px"},children:"No video playlist set yet"}),e.jsx("div",{style:{color:"#64748b",fontSize:"14px"},children:"Please configure the video folder path in the admin settings"})]})})]})}function Et(){const o=te(),[s,i]=r.useState({username:"",password:""}),[n,d]=r.useState(""),[p,w]=r.useState(!1);r.useEffect(()=>{const c=localStorage.getItem("token"),f=JSON.parse(localStorage.getItem("user")||"null");c&&(f==null?void 0:f.role)==="STAFF"&&o("/staff/dashboard")},[o]);const h=async c=>{var f,g;c.preventDefault(),d(""),w(!0);try{const l=await k.post("/auth/staff/login",s);localStorage.setItem("token",l.data.token),localStorage.setItem("user",JSON.stringify(l.data.user)),o("/staff/dashboard")}catch(l){d(((g=(f=l.response)==null?void 0:f.data)==null?void 0:g.error)||"Login failed")}finally{w(!1)}};return e.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:e.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"40px",maxWidth:"400px",width:"100%",boxShadow:"0 20px 60px rgba(0,0,0,0.3)"},children:[e.jsx("div",{style:{marginBottom:"24px",display:"flex",justifyContent:"center"},children:e.jsx(oe,{size:"medium"})}),e.jsx("h1",{style:{fontSize:"28px",fontWeight:"700",marginBottom:"8px",color:"#1e293b",textAlign:"center"},children:"Staff Login"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",textAlign:"center",marginBottom:"32px"},children:"Sign in to manage your queue"}),e.jsxs("form",{onSubmit:h,children:[e.jsx(J,{label:"Username",value:s.username,onChange:c=>i({...s,username:c.target.value}),placeholder:"Enter your username",required:!0,autoFocus:!0}),e.jsx(J,{label:"Password",type:"password",value:s.password,onChange:c=>i({...s,password:c.target.value}),placeholder:"Enter your password",required:!0}),n&&e.jsx("div",{style:{padding:"12px",background:"#fee2e2",color:"#991b1b",borderRadius:"8px",marginBottom:"16px",fontSize:"14px"},children:n}),e.jsx(E,{type:"submit",fullWidth:!0,disabled:p,children:p?"Logging in...":"Login"})]})]})})}function ze({label:o,error:s,children:i,...n}){return e.jsxs("div",{style:{marginBottom:"16px"},children:[o&&e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500",color:"#1e293b"},children:o}),e.jsx("select",{style:{width:"100%",padding:"12px",borderRadius:"8px",border:s?"2px solid #ef4444":"2px solid #e2e8f0",fontSize:"16px",backgroundColor:"white",cursor:"pointer"},...n,children:i}),s&&e.jsx("div",{style:{marginTop:"4px",fontSize:"12px",color:"#ef4444"},children:s})]})}function Nt({onProfileClick:o,onLogout:s}){const[i,n]=r.useState(!1),[d,p]=r.useState(null),[w,h]=r.useState(!0),c=r.useRef(null);r.useEffect(()=>{f()},[]),r.useEffect(()=>{const l=b=>{c.current&&!c.current.contains(b.target)&&n(!1)};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[]);const f=async()=>{try{const l=await k.get("/staff/profile");p(l.data.staff)}catch(l){console.error("Failed to load profile:",l)}finally{h(!1)}},g=l=>{if(!l)return"?";const b=l.trim().split(" ");return b.length>=2?(b[0][0]+b[b.length-1][0]).toUpperCase():l.substring(0,2).toUpperCase()};return w?e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#e2e8f0"}}):e.jsxs("div",{style:{position:"relative"},ref:c,children:[e.jsx("button",{onClick:()=>n(!i),style:{width:"40px",height:"40px",borderRadius:"50%",border:"2px solid #e2e8f0",background:d!=null&&d.profilePicture?`url(${d.profilePicture}) center/cover`:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",fontWeight:"700",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:0,transition:"all 0.2s"},onMouseOver:l=>{l.target.style.borderColor="#2563eb",l.target.style.transform="scale(1.05)"},onMouseOut:l=>{l.target.style.borderColor="#e2e8f0",l.target.style.transform="scale(1)"},children:!(d!=null&&d.profilePicture)&&g(d==null?void 0:d.name)}),i&&e.jsxs("div",{style:{position:"absolute",top:"48px",right:0,background:"white",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",minWidth:"160px",zIndex:1e3,border:"1px solid #e2e8f0",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0",fontSize:"14px",fontWeight:"600",color:"#1e293b"},children:(d==null?void 0:d.name)||"Staff"}),e.jsx("button",{onClick:()=>{n(!1),o()},style:{width:"100%",padding:"12px 16px",border:"none",background:"transparent",textAlign:"left",fontSize:"14px",color:"#1e293b",cursor:"pointer",transition:"background 0.2s"},onMouseOver:l=>{l.target.style.background="#f1f5f9"},onMouseOut:l=>{l.target.style.background="transparent"},children:"Profile"}),e.jsx("button",{onClick:()=>{n(!1),s()},style:{width:"100%",padding:"12px 16px",border:"none",background:"transparent",textAlign:"left",fontSize:"14px",color:"#ef4444",cursor:"pointer",transition:"background 0.2s"},onMouseOver:l=>{l.target.style.background="#fee2e2"},onMouseOut:l=>{l.target.style.background="transparent"},children:"Logout"})]})]})}const Ee={success:{icon:We,color:"#10b981",bg:"#d1fae5"},error:{icon:st,color:"#ef4444",bg:"#fee2e2"},warning:{icon:at,color:"#f59e0b",bg:"#fef3c7"},info:{icon:ot,color:"#2563eb",bg:"#dbeafe"}};let Ot=0;const re=[],de=[];function Ye(o,s="info",i=3e3){const n=Ot++,d={id:n,message:o,type:s,duration:i};return re.push(d),de.forEach(p=>p([...re])),i>0&&setTimeout(()=>{_e(n)},i),n}function _e(o){const s=re.findIndex(i=>i.id===o);s>-1&&(re.splice(s,1),de.forEach(i=>i([...re])))}function G(o,s){return Ye(o,"success",s)}function F(o,s){return Ye(o,"error",s)}function Ft(){const[o,s]=r.useState([]);return r.useEffect(()=>{const i=n=>{s(n)};return de.push(i),s([...re]),()=>{const n=de.indexOf(i);n>-1&&de.splice(n,1)}},[]),e.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:1e4,display:"flex",flexDirection:"column",gap:"12px",pointerEvents:"none"},children:[(o||[]).map(i=>{const n=Ee[i.type]||Ee.info,d=n.icon;return e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"16px 20px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",display:"flex",alignItems:"center",gap:"12px",minWidth:"300px",maxWidth:"400px",pointerEvents:"auto",animation:"slideIn 0.3s ease-out",borderLeft:`4px solid ${n.color}`},children:[e.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",background:n.bg,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(d,{size:16,color:n.color})}),e.jsx("div",{style:{flex:1,fontSize:"14px",color:"#1e293b",lineHeight:"1.5"},children:i.message}),e.jsx("button",{onClick:()=>_e(i.id),style:{background:"none",border:"none",cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center",color:"#64748b",transition:"color 0.2s"},onMouseOver:p=>{p.target.style.color="#1e293b"},onMouseOut:p=>{p.target.style.color="#64748b"},children:e.jsx(_,{size:18})})]},i.id)}),e.jsx("style",{children:`
        @keyframes slideIn {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }
      `})]})}function be({open:o,title:s,message:i,onConfirm:n,onCancel:d,confirmText:p="Confirm",cancelText:w="Cancel",variant:h="danger"}){if(!o)return null;const c={danger:{confirmBg:"#ef4444",confirmHover:"#dc2626"},warning:{confirmBg:"#f59e0b",confirmHover:"#d97706"},info:{confirmBg:"#2563eb",confirmHover:"#1e40af"}},f=c[h]||c.danger;return e.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,animation:"fadeIn 0.2s ease-out"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"400px",width:"90%",boxShadow:"0 10px 25px rgba(0,0,0,0.2)",animation:"slideUp 0.3s ease-out"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1e293b",margin:0},children:s}),e.jsx("button",{onClick:d,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(_,{size:20})})]}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"24px",lineHeight:"1.6"},children:i}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:d,style:{padding:"10px 20px",border:"2px solid #e2e8f0",borderRadius:"8px",background:"transparent",color:"#64748b",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},onMouseOver:g=>{g.target.style.background="#f1f5f9",g.target.style.borderColor="#cbd5e1"},onMouseOut:g=>{g.target.style.background="transparent",g.target.style.borderColor="#e2e8f0"},children:w}),e.jsx("button",{onClick:n,style:{padding:"10px 20px",border:"none",borderRadius:"8px",background:f.confirmBg,color:"white",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},onMouseOver:g=>{g.target.style.background=f.confirmHover,g.target.style.boxShadow="0 4px 8px rgba(0,0,0,0.2)"},onMouseOut:g=>{g.target.style.background=f.confirmBg,g.target.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)"},children:p})]})]}),e.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        @keyframes slideUp {
          from {
            transform: translateY(20px);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }
      `})]})}const Ne=["#2563eb","#10b981","#f59e0b","#ef4444"];function Lt(){const o=te(),[s,i]=r.useState(!0),[n,d]=r.useState(null),[p,w]=r.useState([]),[h,c]=r.useState({}),[f,g]=r.useState([]),[l,b]=r.useState(null),[v,C]=r.useState("today");r.useEffect(()=>{const S=localStorage.getItem("token"),t=JSON.parse(localStorage.getItem("user")||"null");if(!S||(t==null?void 0:t.role)!=="STAFF"){o("/staff/login");return}a(),x();const u=setInterval(a,3e3);return()=>clearInterval(u)},[o]),r.useEffect(()=>{v&&m()},[v]);const a=async()=>{var S;try{const t=await k.get("/staff/dashboard");d(t.data.window),w(t.data.queue||[]),c(t.data.stats||{})}catch(t){console.error("Failed to load dashboard:",t),((S=t.response)==null?void 0:S.status)===401&&o("/staff/login")}finally{i(!1)}},x=async()=>{try{const S=await k.get("/windows/active");g(S.data.windows||[])}catch(S){console.error("Failed to load windows:",S)}},m=async()=>{try{let S,t;const u=new Date;if(v==="today")S=u.toISOString().split("T")[0],t=S;else if(v==="yesterday"){const z=new Date(u);z.setDate(z.getDate()-1),S=z.toISOString().split("T")[0],t=S}else S=u.toISOString().split("T")[0],t=S;const I=await k.get(`/staff/analytics?startDate=${S}&endDate=${t}`);b(I.data)}catch(S){console.error("Failed to load analytics:",S)}},j=async S=>{var t,u;try{await k.post("/staff/assign-window",{windowId:S}),a(),x()}catch(I){console.error("Failed to assign window:",I),alert(((u=(t=I.response)==null?void 0:t.data)==null?void 0:u.error)||"Failed to assign window")}},A=async S=>{var t,u,I,z,B;try{await k.post(`/staff/serve/${S}`),a()}catch(O){console.error("Failed to start serving:",O),((t=O.response)==null?void 0:t.status)===409?(F(((I=(u=O.response)==null?void 0:u.data)==null?void 0:I.error)||"Client was already claimed. Refreshing..."),a()):F(((B=(z=O.response)==null?void 0:z.data)==null?void 0:B.error)||"Failed to start serving")}},U=async S=>{var t,u;try{await k.post(`/staff/complete/${S}`),a(),m()}catch(I){console.error("Failed to complete:",I),alert(((u=(t=I.response)==null?void 0:t.data)==null?void 0:u.error)||"Failed to complete")}},H=async S=>{var t,u;if(n.confirm("Mark this client as skipped?"))try{await k.post(`/staff/skip/${S}`),a()}catch(I){console.error("Failed to skip:",I),alert(((u=(t=I.response)==null?void 0:t.data)==null?void 0:u.error)||"Failed to skip")}},V=async()=>{try{await k.get("/staff/dashboard").then(t=>t.data.window)&&await k.post("/staff/assign-window",{windowId:null})}catch(S){console.error("Error deactivating window on logout:",S)}localStorage.removeItem("token"),localStorage.removeItem("user"),o("/staff/login")},T=()=>{o("/staff/profile")};if(s)return e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ne,{})});const D=p.filter(S=>["SENIOR_CITIZEN","PWD","PREGNANT"].includes(S.clientType)),q=p.filter(S=>S.clientType==="REGULAR"),M=l!=null&&l.byCategory?Object.entries(l.byCategory).map(([S,t])=>({name:S,value:t})):[],K=l!=null&&l.byClientType?Object.entries(l.byClientType).map(([S,t])=>({name:S,value:t})):[];return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
        @media (max-width: 768px) {
          .staff-dashboard-header {
            flex-wrap: wrap;
            gap: 12px;
          }
          .staff-dashboard-header > div:first-child {
            width: 100%;
            flex-direction: column;
            align-items: flex-start !important;
            gap: 8px !important;
          }
          .staff-dashboard-header-center {
            width: 100%;
            text-align: left;
          }
          .staff-dashboard-main-grid {
            grid-template-columns: 1fr !important;
          }
          .staff-dashboard-content {
            padding: 16px !important;
          }
          .queue-item-grid {
            grid-template-columns: 1fr !important;
            gap: 12px !important;
          }
          .queue-item-buttons {
            flex-direction: row !important;
            width: 100% !important;
          }
          .queue-item-buttons button {
            flex: 1;
          }
        }
        @media (max-width: 1024px) and (min-width: 769px) {
          .staff-dashboard-main-grid {
            grid-template-columns: 60% 40% !important;
          }
        }
      `}),e.jsxs("div",{style:{minHeight:"100vh",background:"#f8fafc"},children:[e.jsxs("div",{className:"staff-dashboard-header",style:{background:"white",borderBottom:"1px solid #e2e8f0",padding:"16px 24px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"24px",flex:1},children:[e.jsx(oe,{size:"small"}),n&&e.jsxs("div",{className:"staff-dashboard-header-center",style:{fontSize:"18px",fontWeight:"600",color:"#1e293b"},children:["Operating: ",n.label]})]}),e.jsx(Nt,{onProfileClick:T,onLogout:V})]}),e.jsxs("div",{className:"staff-dashboard-content",style:{maxWidth:"1400px",margin:"0 auto",padding:"24px"},children:[!n&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",marginBottom:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h2",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Assign Window"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"12px"},children:f.map(S=>e.jsx(E,{onClick:()=>j(S.id),variant:"outline",children:S.label},S.id))})]}),e.jsxs("div",{className:"staff-dashboard-main-grid",style:{display:"grid",gridTemplateColumns:"75% 25%",gap:"24px"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsxs("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"20px"},children:["Queue (",p.length,")"]}),D.length>0&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:"#f59e0b",marginBottom:"12px"},children:"Priority Clients"}),D.map(S=>e.jsx(Oe,{entry:S,onServe:A,onComplete:U,onSkip:H},S.id))]}),q.length>0&&e.jsxs("div",{children:[D.length>0&&e.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:"#64748b",marginBottom:"12px"},children:"Regular Clients"}),q.map(S=>e.jsx(Oe,{entry:S,onServe:A,onComplete:U,onSkip:H},S.id))]}),p.length===0&&e.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#94a3b8"},children:"No clients in queue"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("div",{style:{fontSize:"14px",color:"#64748b",marginBottom:"8px"},children:"In Queue"}),e.jsx("div",{style:{fontSize:"32px",fontWeight:"700",color:"#f59e0b"},children:p.length})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("div",{style:{fontSize:"14px",color:"#64748b",marginBottom:"8px"},children:"Total Served Today"}),e.jsx("div",{style:{fontSize:"32px",fontWeight:"700",color:"#2563eb"},children:h.totalServed||0})]})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600"},children:"Analytics"}),e.jsxs(ze,{value:v,onChange:S=>C(S.target.value),style:{width:"100%"},children:[e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"yesterday",children:"Yesterday"})]})]}),l&&e.jsxs(e.Fragment,{children:[M.length>0&&e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx("h3",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"12px"},children:"By Category"}),e.jsx(se,{width:"100%",height:200,children:e.jsxs(Ie,{data:M,children:[e.jsx(ge,{strokeDasharray:"3 3"}),e.jsx(fe,{dataKey:"name"}),e.jsx(he,{}),e.jsx(ie,{}),e.jsx(Te,{dataKey:"value",fill:"#2563eb"})]})})]}),K.length>0&&e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"12px"},children:"By Client Type"}),e.jsx(se,{width:"100%",height:200,children:e.jsxs(Ue,{children:[e.jsx(He,{data:K,cx:"50%",cy:"50%",labelLine:!1,label:({name:S,percent:t})=>`${S}: ${(t*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:K.map((S,t)=>e.jsx(qe,{fill:Ne[t%Ne.length]},`cell-${t}`))}),e.jsx(ie,{})]})})]})]})]})]})]})]})]})]})}function Oe({entry:o,onServe:s,onComplete:i,onSkip:n}){var p,w,h;const d=o.status==="NOW_SERVING";return e.jsxs("div",{className:"queue-item-grid",style:{padding:"16px",border:d?"2px solid #2563eb":"1px solid #e2e8f0",borderRadius:"8px",marginBottom:"12px",background:d?"#eff6ff":"white",display:"grid",gridTemplateColumns:"1fr auto",gap:"20px",alignItems:"start"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#2563eb",marginBottom:"4px"},children:o.queueNumber}),e.jsx("div",{style:{fontSize:"14px",color:"#1e293b",marginBottom:"4px"},children:o.clientName}),e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center",marginBottom:"8px",flexWrap:"wrap"},children:[e.jsx(Ge,{clientType:o.clientType}),e.jsxs("span",{style:{fontSize:"12px",color:"#64748b"},children:[((p=o.concernCategories)!=null&&p.length?o.concernCategories:o.category?[o.category]:[]).map(c=>c==null?void 0:c.name).filter(Boolean).join(", "),((w=o.concernSubCategories)!=null&&w.length?o.concernSubCategories:o.subCategory?[o.subCategory]:[]).map(c=>c==null?void 0:c.name).filter(Boolean).length>0&&` - ${((h=o.concernSubCategories)!=null&&h.length?o.concernSubCategories:[o.subCategory]).map(c=>c==null?void 0:c.name).filter(Boolean).join(", ")}`]})]}),e.jsxs("div",{style:{fontSize:"12px",color:"#94a3b8"},children:["Joined: ",new Date(o.joinedAt).toLocaleTimeString()]})]}),e.jsxs("div",{className:"queue-item-buttons",style:{display:"flex",gap:"8px",flexDirection:"column"},children:[d?e.jsx(E,{variant:"success",icon:We,onClick:()=>i(o.id),style:{fontSize:"12px",padding:"8px 16px",whiteSpace:"nowrap"},children:"Mark as Served"}):e.jsx(E,{variant:"primary",icon:it,onClick:()=>s(o.id),style:{fontSize:"12px",padding:"8px 16px",whiteSpace:"nowrap"},children:"Start Serving"}),e.jsx(E,{variant:"danger",icon:rt,onClick:()=>n(o.id),style:{fontSize:"12px",padding:"8px 16px",whiteSpace:"nowrap"},children:"Skip"})]})]})}function Mt(){const o=te(),[s,i]=r.useState(!0),[n,d]=r.useState(!1),[p,w]=r.useState(null),[h,c]=r.useState(null),[f,g]=r.useState(null),[l,b]=r.useState(!1),[v,C]=r.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[a,x]=r.useState(!1);r.useEffect(()=>{const T=localStorage.getItem("token"),D=JSON.parse(localStorage.getItem("user")||"null");if(!T||(D==null?void 0:D.role)!=="STAFF"){o("/staff/login");return}m()},[o]);const m=async()=>{var T;try{const D=await k.get("/staff/profile");w(D.data.staff),c(D.data.staff.profilePicture)}catch(D){console.error("Failed to load profile:",D),((T=D.response)==null?void 0:T.status)===401&&o("/staff/login")}finally{i(!1)}},j=T=>{const D=T.target.files[0];if(D){const q=new FileReader;q.onloadend=()=>{g(q.result)},q.readAsDataURL(D),c(D)}},A=async T=>{var D,q;T.preventDefault(),d(!0);try{if(await k.put("/staff/profile",{name:p.name}),h instanceof File){const M=new FormData;M.append("picture",h);const K=await k.post("/staff/profile/picture",M,{headers:{"Content-Type":"multipart/form-data"}});c(K.data.profilePicture),g(null)}G("Profile updated successfully!"),o("/staff/dashboard")}catch(M){console.error("Failed to update profile:",M),F(((q=(D=M.response)==null?void 0:D.data)==null?void 0:q.error)||"Failed to update profile")}finally{d(!1)}},U=async T=>{var D,q;if(T.preventDefault(),v.newPassword!==v.confirmPassword){F("New passwords do not match");return}if(v.newPassword.length<6){F("Password must be at least 6 characters");return}x(!0);try{await k.post("/staff/profile/change-password",{currentPassword:v.currentPassword,newPassword:v.newPassword}),G("Password changed successfully!"),b(!1),C({currentPassword:"",newPassword:"",confirmPassword:""})}catch(M){console.error("Failed to change password:",M),F(((q=(D=M.response)==null?void 0:D.data)==null?void 0:q.error)||"Failed to change password")}finally{x(!1)}};if(s)return e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ne,{})});const H=T=>{if(!T)return"?";const D=T.trim().split(" ");return D.length>=2?(D[0][0]+D[D.length-1][0]).toUpperCase():T.substring(0,2).toUpperCase()},V=f||(p!=null&&p.profilePicture?p.profilePicture:null);return e.jsxs("div",{style:{minHeight:"100vh",background:"#f8fafc"},children:[e.jsxs("div",{style:{background:"white",borderBottom:"1px solid #e2e8f0",padding:"16px 24px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(oe,{size:"small"}),e.jsx(E,{variant:"outline",onClick:()=>o("/staff/dashboard"),children:"Back to Dashboard"})]}),e.jsx("div",{style:{maxWidth:"600px",margin:"40px auto",padding:"0 24px"},children:e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"32px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"32px",color:"#1e293b"},children:"My Profile"}),e.jsxs("form",{onSubmit:A,children:[e.jsxs("div",{style:{marginBottom:"32px",textAlign:"center"},children:[e.jsx("div",{style:{width:"120px",height:"120px",borderRadius:"50%",margin:"0 auto 16px",border:"3px solid #e2e8f0",background:V?`url(${V}) center/cover`:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",fontWeight:"700",fontSize:"36px",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:!V&&H(p==null?void 0:p.name)}),e.jsxs("label",{style:{display:"inline-block",padding:"8px 16px",background:"#2563eb",color:"white",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"background 0.2s"},onMouseOver:T=>{T.target.style.background="#1e40af"},onMouseOut:T=>{T.target.style.background="#2563eb"},children:["Change Picture",e.jsx("input",{type:"file",accept:"image/*",onChange:j,style:{display:"none"}})]}),e.jsx("p",{style:{fontSize:"12px",color:"#64748b",marginTop:"8px"},children:"JPG, PNG, GIF, WebP (max 2MB)"})]}),e.jsx(J,{label:"Name",value:(p==null?void 0:p.name)||"",onChange:T=>w({...p,name:T.target.value}),required:!0}),e.jsx(J,{label:"Username",value:(p==null?void 0:p.username)||"",disabled:!0,style:{background:"#f1f5f9"}}),e.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"24px"},children:[e.jsx(E,{type:"submit",disabled:n,fullWidth:!0,children:n?"Saving...":"Save Changes"}),e.jsx(E,{variant:"outline",onClick:()=>o("/staff/dashboard"),fullWidth:!0,children:"Cancel"})]})]}),e.jsxs("div",{style:{marginTop:"32px",paddingTop:"32px",borderTop:"1px solid #e2e8f0"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1e293b"},children:"Change Password"}),e.jsx(E,{variant:"outline",onClick:()=>{b(!l),l&&C({currentPassword:"",newPassword:"",confirmPassword:""})},children:l?"Cancel":"Change Password"})]}),l&&e.jsxs("form",{onSubmit:U,children:[e.jsx(J,{label:"Current Password",type:"password",value:v.currentPassword,onChange:T=>C({...v,currentPassword:T.target.value}),required:!0}),e.jsx(J,{label:"New Password",type:"password",value:v.newPassword,onChange:T=>C({...v,newPassword:T.target.value}),required:!0}),e.jsx(J,{label:"Confirm New Password",type:"password",value:v.confirmPassword,onChange:T=>C({...v,confirmPassword:T.target.value}),required:!0}),e.jsx(E,{type:"submit",disabled:a,fullWidth:!0,style:{marginTop:"16px"},children:a?"Changing...":"Change Password"})]})]})]})})]})}function Ut(){const o=te(),[s,i]=r.useState({username:"",password:""}),[n,d]=r.useState(""),[p,w]=r.useState(!1);r.useEffect(()=>{const c=localStorage.getItem("token"),f=JSON.parse(localStorage.getItem("user")||"null");c&&(f==null?void 0:f.role)==="ADMIN"&&o("/admin/dashboard")},[o]);const h=async c=>{var f,g;c.preventDefault(),d(""),w(!0);try{const l=await k.post("/auth/admin/login",s);localStorage.setItem("token",l.data.token),localStorage.setItem("user",JSON.stringify(l.data.user)),o("/admin/dashboard")}catch(l){d(((g=(f=l.response)==null?void 0:f.data)==null?void 0:g.error)||"Login failed")}finally{w(!1)}};return e.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:e.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"40px",maxWidth:"400px",width:"100%",boxShadow:"0 20px 60px rgba(0,0,0,0.3)"},children:[e.jsx("div",{style:{marginBottom:"24px",display:"flex",justifyContent:"center"},children:e.jsx(oe,{size:"medium"})}),e.jsx("h1",{style:{fontSize:"28px",fontWeight:"700",marginBottom:"8px",color:"#1e293b",textAlign:"center"},children:"Admin Login"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",textAlign:"center",marginBottom:"32px"},children:"Sign in to manage the system"}),e.jsxs("form",{onSubmit:h,children:[e.jsx(J,{label:"Username",value:s.username,onChange:c=>i({...s,username:c.target.value}),placeholder:"Enter your username",required:!0,autoFocus:!0}),e.jsx(J,{label:"Password",type:"password",value:s.password,onChange:c=>i({...s,password:c.target.value}),placeholder:"Enter your password",required:!0}),n&&e.jsx("div",{style:{padding:"12px",background:"#fee2e2",color:"#991b1b",borderRadius:"8px",marginBottom:"16px",fontSize:"14px"},children:n}),e.jsx(E,{type:"submit",fullWidth:!0,disabled:p,children:p?"Logging in...":"Login"})]})]})})}function Ht({onLogout:o}){const[s,i]=r.useState(!1),[n,d]=r.useState(null),[p,w]=r.useState(!0),h=r.useRef(null);te(),r.useEffect(()=>{c()},[]),r.useEffect(()=>{const g=l=>{h.current&&!h.current.contains(l.target)&&i(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]);const c=async()=>{try{const g=JSON.parse(localStorage.getItem("user")||"null");g&&d({name:g.name||"Admin",username:g.username})}catch(g){console.error("Failed to load profile:",g)}finally{w(!1)}},f=g=>{if(!g)return"A";const l=g.trim().split(" ");return l.length>=2?(l[0][0]+l[l.length-1][0]).toUpperCase():g.substring(0,2).toUpperCase()};return p?e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#e2e8f0"}}):e.jsxs("div",{style:{position:"relative"},ref:h,children:[e.jsx("button",{onClick:()=>i(!s),style:{width:"40px",height:"40px",borderRadius:"50%",border:"2px solid #e2e8f0",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",fontWeight:"700",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:0,transition:"all 0.2s"},onMouseOver:g=>{g.target.style.borderColor="#2563eb",g.target.style.transform="scale(1.05)"},onMouseOut:g=>{g.target.style.borderColor="#e2e8f0",g.target.style.transform="scale(1)"},children:f(n==null?void 0:n.name)}),s&&e.jsxs("div",{style:{position:"absolute",top:"48px",right:0,background:"white",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",minWidth:"160px",zIndex:1e3,border:"1px solid #e2e8f0",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0",fontSize:"14px",fontWeight:"600",color:"#1e293b"},children:(n==null?void 0:n.name)||"Admin"}),e.jsx("button",{onClick:()=>{i(!1),o()},style:{width:"100%",padding:"12px 16px",border:"none",background:"transparent",textAlign:"left",fontSize:"14px",color:"#ef4444",cursor:"pointer",transition:"background 0.2s"},onMouseOver:g=>{g.target.style.background="#fee2e2"},onMouseOut:g=>{g.target.style.background="transparent"},children:"Logout"})]})]})}function qt({open:o,title:s,message:i,placeholder:n="",onConfirm:d,onCancel:p,confirmText:w="Confirm",cancelText:h="Cancel",type:c="text",required:f=!0}){const[g,l]=r.useState("");if(r.useEffect(()=>{o&&l("")},[o]),!o)return null;const b=()=>{f&&!g.trim()||(d(g),l(""))},v=()=>{l(""),p()};return e.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,animation:"fadeIn 0.2s ease-out"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"400px",width:"90%",boxShadow:"0 10px 25px rgba(0,0,0,0.2)",animation:"slideUp 0.3s ease-out"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1e293b",margin:0},children:s}),e.jsx("button",{onClick:v,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(_,{size:20})})]}),i&&e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"16px",lineHeight:"1.6"},children:i}),e.jsx("input",{type:c,value:g,onChange:C=>l(C.target.value),placeholder:n,required:f,style:{width:"100%",padding:"10px 12px",border:"2px solid #e2e8f0",borderRadius:"8px",fontSize:"14px",marginBottom:"24px",transition:"border-color 0.2s"},onFocus:C=>{C.target.style.borderColor="#2563eb"},onBlur:C=>{C.target.style.borderColor="#e2e8f0"},onKeyDown:C=>{C.key==="Enter"?b():C.key==="Escape"&&v()},autoFocus:!0}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:v,style:{padding:"10px 20px",border:"2px solid #e2e8f0",borderRadius:"8px",background:"transparent",color:"#64748b",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},onMouseOver:C=>{C.target.style.background="#f1f5f9",C.target.style.borderColor="#cbd5e1"},onMouseOut:C=>{C.target.style.background="transparent",C.target.style.borderColor="#e2e8f0"},children:h}),e.jsx("button",{onClick:b,disabled:f&&!g.trim(),style:{padding:"10px 20px",border:"none",borderRadius:"8px",background:f&&!g.trim()?"#cbd5e1":"#2563eb",color:"white",fontSize:"14px",fontWeight:"600",cursor:f&&!g.trim()?"not-allowed":"pointer",transition:"all 0.2s",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},onMouseOver:C=>{f&&!g.trim()||(C.target.style.background="#1e40af",C.target.style.boxShadow="0 4px 8px rgba(0,0,0,0.2)")},onMouseOut:C=>{f&&!g.trim()||(C.target.style.background="#2563eb",C.target.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)")},children:w})]})]}),e.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        @keyframes slideUp {
          from {
            transform: translateY(20px);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }
      `})]})}const Fe=["#2563eb","#10b981","#f59e0b","#ef4444","#8b5cf6"];function Vt(){const o=te(),[s,i]=r.useState("dashboard"),[n,d]=r.useState(!0),[p,w]=r.useState(null),[h,c]=r.useState([]),[f,g]=r.useState([]),[l,b]=r.useState([]),[v,C]=r.useState(null),[a,x]=r.useState({startDate:new Date().toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0],staffIds:[],categoryIds:[],clientTypes:[],startHour:"",endHour:""}),[m,j]=r.useState(!1),[A,U]=r.useState({open:!1,data:{}}),[H,V]=r.useState({open:!1,data:{}}),[T,D]=r.useState({open:!1,data:{}}),[q,M]=r.useState({open:!1,data:{}}),[K,S]=r.useState({open:!1,title:"",message:"",placeholder:"",type:"text",onConfirm:()=>{},onCancel:()=>{}});r.useEffect(()=>{const R=localStorage.getItem("token"),Y=JSON.parse(localStorage.getItem("user")||"null");if(!R||(Y==null?void 0:Y.role)!=="ADMIN"){o("/admin/login");return}t();const L=setInterval(()=>{s==="dashboard"&&u()},3e3);return()=>clearInterval(L)},[o,s]),r.useEffect(()=>{s==="reports"&&O()},[s,a]);const t=async()=>{try{await Promise.all([u(),I(),z(),B()])}catch(R){console.error("Error loading data:",R)}finally{d(!1)}},u=async()=>{try{const R=await k.get("/admin/dashboard");w(R.data.stats)}catch(R){console.error("Failed to load dashboard:",R)}},I=async()=>{try{const R=await k.get("/admin/staff");c(R.data.staff)}catch(R){console.error("Failed to load staff:",R)}},z=async()=>{try{const R=await k.get("/admin/windows");g(R.data.windows)}catch(R){console.error("Failed to load windows:",R)}},B=async()=>{try{const R=await k.get("/categories");b(R.data.categories)}catch(R){console.error("Failed to load categories:",R)}},O=async()=>{try{const R=new URLSearchParams;R.append("startDate",a.startDate),R.append("endDate",a.endDate),a.staffIds&&a.staffIds.length>0&&a.staffIds.forEach(L=>R.append("staffId",L)),a.categoryIds&&a.categoryIds.length>0&&a.categoryIds.forEach(L=>R.append("categoryId",L)),a.clientTypes&&a.clientTypes.length>0&&a.clientTypes.forEach(L=>R.append("clientType",L)),a.startHour&&R.append("startHour",a.startHour),a.endHour&&R.append("endHour",a.endHour);const Y=await k.get(`/admin/reports?${R.toString()}`);C(Y.data)}catch(R){console.error("Failed to load reports:",R)}},$=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),o("/admin/login")};return n?e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ne,{})}):e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
        @media (max-width: 768px) {
          .admin-dashboard-header {
            flex-wrap: wrap;
            gap: 12px;
          }
          .admin-dashboard-header > div:first-child {
            width: 100%;
            flex-direction: column;
            align-items: flex-start !important;
            gap: 8px !important;
          }
          .admin-dashboard-header h1 {
            font-size: 20px !important;
          }
          .admin-dashboard-tabs {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            padding: 0 16px !important;
          }
          .admin-dashboard-tabs button {
            white-space: nowrap;
            font-size: 13px;
            padding: 10px 16px !important;
          }
          .admin-dashboard-tabs button span {
            display: none;
          }
          .admin-dashboard-content {
            padding: 16px !important;
          }
          .admin-stats-grid {
            grid-template-columns: repeat(2, 1fr) !important;
          }
          .admin-stats-grid-4 {
            grid-template-columns: repeat(2, 1fr) !important;
          }
          .admin-cards-grid {
            grid-template-columns: repeat(2, 1fr) !important;
          }
          .admin-reports-grid {
            grid-template-columns: 1fr !important;
          }
          .admin-filter-grid {
            grid-template-columns: 1fr !important;
          }
          .admin-page-header {
            flex-direction: column;
            align-items: flex-start !important;
            gap: 12px;
          }
          .settings-grid {
            grid-template-columns: minmax(0, 1fr) !important;
          }
        }
        @media (max-width: 480px) {
          .admin-stats-grid,
          .admin-stats-grid-4,
          .admin-cards-grid {
            grid-template-columns: 1fr !important;
          }
        }
        @media (max-width: 1024px) and (min-width: 769px) {
          .admin-stats-grid-4 {
            grid-template-columns: repeat(2, 1fr) !important;
          }
          .admin-cards-grid {
            grid-template-columns: repeat(3, 1fr) !important;
          }
          .settings-grid {
            grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
            gap: 16px;
          }
        }
      `}),e.jsxs("div",{style:{minHeight:"100vh",background:"#f8fafc"},children:[e.jsx(qt,{...K}),e.jsxs("div",{className:"admin-dashboard-header",style:{background:"white",borderBottom:"1px solid #e2e8f0",padding:"16px 24px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"24px",flex:1},children:[e.jsx(oe,{size:"small"}),e.jsx("h1",{style:{fontSize:"24px",fontWeight:"700",color:"#1e293b",margin:0},children:"Admin Dashboard"})]}),e.jsx(Ht,{onLogout:$})]}),e.jsx("div",{className:"admin-dashboard-tabs",style:{background:"white",borderBottom:"1px solid #e2e8f0",padding:"0 24px",display:"flex",gap:"4px"},children:[{id:"dashboard",label:"Dashboard",icon:lt},{id:"staff",label:"Staff",icon:dt},{id:"windows",label:"Windows",icon:Le},{id:"categories",label:"Categories",icon:Me},{id:"reports",label:"Reports",icon:ct},{id:"settings",label:"Settings",icon:pt}].map(R=>{const Y=R.icon,L=s===R.id;return e.jsxs("button",{onClick:()=>i(R.id),style:{padding:"12px 20px",border:"none",background:L?"#eff6ff":"transparent",borderBottom:L?"3px solid #2563eb":"3px solid transparent",color:L?"#2563eb":"#64748b",fontWeight:L?"600":"400",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s",borderRadius:"8px 8px 0 0"},onMouseOver:X=>{L||(X.target.style.background="#f1f5f9",X.target.style.color="#475569")},onMouseOut:X=>{L||(X.target.style.background="transparent",X.target.style.color="#64748b")},children:[e.jsx(Y,{size:18}),e.jsx("span",{children:R.label})]},R.id)})}),e.jsxs("div",{className:"admin-dashboard-content",style:{maxWidth:"1400px",margin:"0 auto",padding:"24px"},children:[s==="dashboard"&&e.jsx($t,{stats:p}),s==="staff"&&e.jsx(Gt,{staff:h,categories:l,onRefresh:I,form:A,setForm:U,setInputDialog:S}),s==="windows"&&e.jsx(Yt,{windows:f,onRefresh:z,form:H,setForm:V}),s==="categories"&&e.jsx(_t,{categories:l,onRefresh:B,categoryForm:T,setCategoryForm:D,subCategoryForm:q,setSubCategoryForm:M}),s==="reports"&&e.jsx(Jt,{reports:v,filters:a,setFilters:x,staff:h,categories:l,showFilters:m,setShowFilters:j,onRefresh:O}),s==="settings"&&e.jsx(Qt,{})]})]})]})}function $t({stats:o}){const[s,i]=r.useState(new Date);if(r.useEffect(()=>{const d=setInterval(()=>{i(new Date)},1e3);return()=>clearInterval(d)},[]),!o)return e.jsx(ne,{});const n=d=>{const p=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],w=["January","February","March","April","May","June","July","August","September","October","November","December"],h=p[d.getDay()],c=w[d.getMonth()],f=d.getDate(),g=d.getFullYear();let l=d.getHours();const b=String(d.getMinutes()).padStart(2,"0"),v=String(d.getSeconds()).padStart(2,"0"),C=l>=12?"PM":"AM";return l=l%12,l=l||12,`${h}, ${c} ${f}, ${g} at ${l}:${b}:${v} ${C}`};return e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#1e293b"},children:n(s)})}),e.jsxs("div",{className:"admin-stats-grid-4",style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"16px"},children:[e.jsx(Z,{label:"Queue Entries Today",value:o.todayQueueEntries,icon:xt,color:"#2563eb"}),e.jsx(Z,{label:"Serving",value:o.servingCount,icon:ut,color:"#2563eb"}),e.jsx(Z,{label:"Waiting",value:o.waitingCount,icon:gt,color:"#f59e0b"}),e.jsx(Z,{label:"Served Today",value:o.todayServed,icon:We,color:"#10b981"})]}),e.jsxs("div",{className:"admin-stats-grid-4",style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"24px"},children:[e.jsx(Z,{label:"Active Windows",value:o.activeWindows,icon:ft,color:"#10b981"}),e.jsx(Z,{label:"Active Staff",value:o.activeStaff,icon:ht,color:"#10b981"}),e.jsx(Z,{label:"Total Windows",value:o.totalWindows,icon:mt,color:"#2563eb"}),e.jsx(Z,{label:"Total Staff",value:o.totalStaff,icon:yt,color:"#2563eb"})]})]})}function Z({label:o,value:s,color:i="#2563eb",icon:n}){return e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px"},children:[n&&e.jsx(n,{size:20,color:i,style:{flexShrink:0}}),e.jsx("div",{style:{fontSize:"14px",color:"#64748b",fontWeight:"500"},children:o})]}),e.jsx("div",{style:{fontSize:"32px",fontWeight:"700",color:i,lineHeight:"1.2"},children:s||0})]})}function Gt({staff:o,categories:s,onRefresh:i,form:n,setForm:d,setInputDialog:p}){const[w,h]=r.useState(null),[c,f]=r.useState(!1),g=r.useRef(null);r.useEffect(()=>{const a=x=>{g.current&&!g.current.contains(x.target)&&f(!1)};return c&&document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}},[c]);const l=async a=>{var x,m;a.preventDefault();try{await k.post("/admin/staff",n.data),d({open:!1,data:{}}),G("Staff created successfully!"),i()}catch(j){F(((m=(x=j.response)==null?void 0:x.data)==null?void 0:m.error)||"Failed to create staff")}},b=async a=>{var x,m;a.preventDefault();try{await k.put(`/admin/staff/${w.id}`,n.data),d({open:!1,data:{}}),h(null),G("Staff updated successfully!"),i()}catch(j){F(((m=(x=j.response)==null?void 0:x.data)==null?void 0:m.error)||"Failed to update staff")}},v=async(a,x)=>{var m,j;try{await k.put(`/admin/staff/${a}`,{isActive:!x}),G(`Staff ${x?"deactivated":"activated"} successfully!`),i()}catch(A){F(((j=(m=A.response)==null?void 0:m.data)==null?void 0:j.error)||"Failed to update staff")}},C=async(a,x)=>{p({open:!0,title:"Reset Password",message:`Enter new password for ${x}:`,placeholder:"New password (min 6 characters)",type:"password",onConfirm:async m=>{var j,A;if(p({open:!1}),!!m){if(m.length<6){F("Password must be at least 6 characters");return}try{await k.post(`/admin/staff/${a}/reset-password`,{password:m}),G("Password reset successfully!")}catch(U){F(((A=(j=U.response)==null?void 0:j.data)==null?void 0:A.error)||"Failed to reset password")}}},onCancel:()=>p({open:!1})})};return e.jsxs("div",{children:[e.jsxs("div",{className:"admin-page-header",style:{display:"flex",justifyContent:"space-between",marginBottom:"24px"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600"},children:"Staff Management"}),e.jsx(E,{onClick:()=>{d({open:!0,data:{}}),h(null)},children:"Add Staff"})]}),n.open&&ce.createPortal(e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:()=>{d({open:!1,data:{}}),h(null)},children:e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"500px",width:"90%",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h3",{style:{fontSize:"20px",fontWeight:"600",margin:0},children:w?"Edit Staff":"Create Staff"}),e.jsx("button",{onClick:()=>{d({open:!1,data:{}}),h(null)},style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(_,{size:20})})]}),e.jsxs("form",{onSubmit:w?b:l,children:[e.jsx(J,{label:"Username",value:n.data.username||"",onChange:a=>d({...n,data:{...n.data,username:a.target.value}}),required:!w,disabled:!!w}),e.jsx(J,{label:"Name",value:n.data.name||"",onChange:a=>d({...n,data:{...n.data,name:a.target.value}}),required:!0}),(!w||n.data.password)&&e.jsx(J,{label:"Password",type:"password",value:n.data.password||"",onChange:a=>d({...n,data:{...n.data,password:a.target.value}}),required:!w}),e.jsxs("div",{style:{marginBottom:"16px",position:"relative"},ref:g,children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500",color:"#1e293b"},children:"Specializations (Categories)"}),e.jsx("div",{onClick:()=>f(!c),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px",backgroundColor:"white",cursor:"pointer",minHeight:"44px",display:"flex",alignItems:"center",flexWrap:"wrap",gap:"6px"},children:n.data.categoryIds&&n.data.categoryIds.length>0?n.data.categoryIds.map(a=>{const x=s.find(m=>m.id===a);return x?e.jsxs("span",{style:{fontSize:"12px",padding:"4px 8px",borderRadius:"6px",background:"#eff6ff",color:"#2563eb",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},onClick:m=>{m.stopPropagation(),d({...n,data:{...n.data,categoryIds:n.data.categoryIds.filter(j=>j!==a)}})},children:[x.name,e.jsx(_,{size:12})]},a):null}):e.jsx("span",{style:{color:"#94a3b8"},children:"Select categories..."})}),c&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"white",border:"2px solid #e2e8f0",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:s.map(a=>{var m;const x=((m=n.data.categoryIds)==null?void 0:m.includes(a.id))||!1;return e.jsxs("div",{onClick:()=>{const j=n.data.categoryIds||[];d(x?{...n,data:{...n.data,categoryIds:j.filter(A=>A!==a.id)}}:{...n,data:{...n.data,categoryIds:[...j,a.id]}})},style:{padding:"10px 12px",cursor:"pointer",background:x?"#eff6ff":"white",color:x?"#2563eb":"#1e293b",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid #f1f5f9"},onMouseOver:j=>{x||(j.currentTarget.style.background="#f8fafc")},onMouseOut:j=>{x||(j.currentTarget.style.background="white")},children:[e.jsx("input",{type:"checkbox",checked:x,onChange:()=>{},style:{cursor:"pointer"}}),e.jsx("span",{children:a.name})]},a.id)})})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[e.jsx(E,{variant:"outline",icon:_,onClick:()=>{d({open:!1,data:{}}),h(null)},children:"Cancel"}),e.jsx(E,{type:"submit",icon:pe,children:w?"Update":"Create"})]})]})]})}),document.body),e.jsx("div",{className:"admin-cards-grid",style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:o.map(a=>{const x=a.name?a.name.split(" ").map(j=>j[0]).join("").toUpperCase().slice(0,2):a.username.charAt(0).toUpperCase(),m=a.specializations?a.specializations.map(j=>j.category.name):[];return e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"16px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",gap:"12px",alignItems:"center"},children:[e.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",background:a.profilePictureUrl?"transparent":"#2563eb",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",marginBottom:"8px",border:a.profilePictureUrl?"2px solid #e2e8f0":"none"},children:a.profilePictureUrl?e.jsx("img",{src:a.profilePictureUrl,alt:a.name,style:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsx("span",{style:{color:"white",fontSize:"28px",fontWeight:"600"},children:x})}),e.jsxs("div",{style:{textAlign:"center",marginBottom:"8px"},children:[e.jsx("div",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"2px"},children:a.name}),e.jsx("div",{style:{fontSize:"12px",color:"#64748b"},children:a.username})]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",justifyContent:"center",marginBottom:"8px"},children:m.length>0?m.map((j,A)=>e.jsx("span",{style:{fontSize:"11px",padding:"4px 8px",borderRadius:"12px",background:"#eff6ff",color:"#2563eb",fontWeight:"500"},children:j},A)):e.jsx("span",{style:{fontSize:"11px",padding:"4px 8px",borderRadius:"12px",background:"#f1f5f9",color:"#64748b",fontWeight:"500"},children:"All categories"})}),e.jsx("div",{style:{marginBottom:"8px"},children:e.jsx("span",{style:{fontSize:"11px",padding:"4px 12px",borderRadius:"12px",background:a.isActive?"#ecfdf5":"#fef2f2",color:a.isActive?"#059669":"#dc2626",fontWeight:"600"},children:a.isActive?"Active":"Inactive"})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",marginTop:"auto",width:"100%"},children:[e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsxs("button",{onClick:()=>{h(a),d({open:!0,data:{username:a.username,name:a.name,categoryIds:a.specializations?a.specializations.map(j=>j.categoryId):[]}})},style:{fontSize:"12px",padding:"6px 12px",border:"none",background:"transparent",color:"#2563eb",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",fontWeight:"500",borderRadius:"6px",transition:"all 0.2s",width:"25%"},onMouseOver:j=>{j.target.style.background="#eff6ff"},onMouseOut:j=>{j.target.style.background="transparent"},children:[e.jsx(Re,{size:14}),"Edit"]}),e.jsxs("button",{onClick:()=>C(a.id,a.name),style:{fontSize:"12px",padding:"6px 12px",border:"none",background:"transparent",color:"#2563eb",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",fontWeight:"500",borderRadius:"6px",transition:"all 0.2s",width:"75%"},onMouseOver:j=>{j.target.style.background="#eff6ff"},onMouseOut:j=>{j.target.style.background="transparent"},children:[e.jsx(bt,{size:14}),"Reset Password"]})]}),e.jsx(E,{variant:a.isActive?"danger":"success",icon:jt,onClick:()=>v(a.id,a.isActive),style:{fontSize:"12px",padding:"6px 12px",width:"100%"},children:a.isActive?"Deactivate":"Activate"})]})]},a.id)})})]})}function Yt({windows:o,onRefresh:s,form:i,setForm:n}){const[d,p]=r.useState(null),[w,h]=r.useState({open:!1}),c=async l=>{var b,v;l.preventDefault();try{await k.post("/admin/windows",i.data),n({open:!1,data:{}}),G("Window created successfully!"),s()}catch(C){F(((v=(b=C.response)==null?void 0:b.data)==null?void 0:v.error)||"Failed to create window")}},f=async l=>{var b,v;l.preventDefault();try{await k.put(`/admin/windows/${d.id}`,i.data),n({open:!1,data:{}}),p(null),G("Window updated successfully!"),s()}catch(C){F(((v=(b=C.response)==null?void 0:b.data)==null?void 0:v.error)||"Failed to update window")}},g=async l=>{h({open:!0,title:"Delete Window",message:"Are you sure you want to delete this window? This action cannot be undone.",onConfirm:async()=>{var b,v;h({open:!1});try{await k.delete(`/admin/windows/${l}`),G("Window deleted successfully!"),s()}catch(C){F(((v=(b=C.response)==null?void 0:b.data)==null?void 0:v.error)||"Failed to delete window")}},onCancel:()=>h({open:!1})})};return e.jsxs("div",{children:[e.jsx(be,{...w}),e.jsxs("div",{className:"admin-page-header",style:{display:"flex",justifyContent:"space-between",marginBottom:"24px"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600"},children:"Window Management"}),e.jsx(E,{icon:Ce,onClick:()=>{n({open:!0,data:{isActive:!0}}),p(null)},children:"Add Window"})]}),i.open&&ce.createPortal(e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:()=>{n({open:!1,data:{}}),p(null)},children:e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"500px",width:"90%",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h3",{style:{fontSize:"20px",fontWeight:"600",margin:0},children:d?"Edit Window":"Create Window"}),e.jsx("button",{onClick:()=>{n({open:!1,data:{}}),p(null)},style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(_,{size:20})})]}),e.jsxs("form",{onSubmit:d?f:c,children:[e.jsx(J,{label:"Window Label",value:i.data.label||"",onChange:l=>n({...i,data:{...i.data,label:l.target.value}}),required:!0}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[e.jsx("input",{type:"checkbox",checked:i.data.isActive!==!1,onChange:l=>n({...i,data:{...i.data,isActive:l.target.checked}})}),"Active"]}),e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[e.jsx(E,{variant:"outline",icon:_,onClick:()=>{n({open:!1,data:{}}),p(null)},children:"Cancel"}),e.jsx(E,{type:"submit",icon:pe,children:d?"Update":"Create"})]})]})]})}),document.body),e.jsx("div",{className:"admin-cards-grid",style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:o.map(l=>e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"16px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",gap:"12px",alignItems:"center"},children:[e.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",background:"#2563eb",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px"},children:e.jsx(Le,{size:40,color:"white"})}),e.jsx("div",{style:{textAlign:"center",marginBottom:"8px"},children:e.jsx("div",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"2px"},children:l.label})}),l.assignments&&l.assignments.length>0&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",justifyContent:"center",marginBottom:"8px"},children:l.assignments.map(b=>e.jsx("span",{style:{fontSize:"11px",padding:"4px 8px",borderRadius:"12px",background:"#eff6ff",color:"#2563eb",fontWeight:"500"},children:b.staff.name},b.id))}),e.jsx("div",{style:{marginBottom:"8px"},children:e.jsx("span",{style:{fontSize:"11px",padding:"4px 12px",borderRadius:"12px",background:l.isActive?"#ecfdf5":"#fef2f2",color:l.isActive?"#059669":"#dc2626",fontWeight:"600"},children:l.isActive?"Active":"Inactive"})}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px",marginTop:"auto",width:"100%"},children:e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsxs("button",{onClick:()=>{p(l),n({open:!0,data:{label:l.label,isActive:l.isActive}})},style:{fontSize:"12px",padding:"6px 12px",border:"none",background:"transparent",color:"#2563eb",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",fontWeight:"500",borderRadius:"6px",transition:"all 0.2s",width:"50%"},onMouseOver:b=>{b.target.style.background="#eff6ff"},onMouseOut:b=>{b.target.style.background="transparent"},children:[e.jsx(Re,{size:14}),"Edit"]}),e.jsx(E,{variant:"danger",icon:ke,onClick:()=>g(l.id),style:{fontSize:"12px",padding:"6px 12px",width:"50%"},children:"Delete"})]})})]},l.id))})]})}function _t({categories:o,onRefresh:s,categoryForm:i,setCategoryForm:n,subCategoryForm:d,setSubCategoryForm:p}){const[w,h]=r.useState(null),[c,f]=r.useState({open:!1}),g=async a=>{var x,m;a.preventDefault();try{await k.post("/admin/categories",i.data),n({open:!1,data:{}}),G("Category created successfully!"),s()}catch(j){F(((m=(x=j.response)==null?void 0:x.data)==null?void 0:m.error)||"Failed to create category")}},l=async a=>{var x,m;a.preventDefault();try{await k.put(`/admin/categories/${w.id}`,i.data),n({open:!1,data:{}}),h(null),G("Category updated successfully!"),s()}catch(j){F(((m=(x=j.response)==null?void 0:x.data)==null?void 0:m.error)||"Failed to update category")}},b=async a=>{f({open:!0,title:"Delete Category",message:"Are you sure you want to delete this category? All subcategories will be deleted. This action cannot be undone.",onConfirm:async()=>{var x,m;f({open:!1});try{await k.delete(`/admin/categories/${a}`),G("Category deleted successfully!"),s()}catch(j){F(((m=(x=j.response)==null?void 0:x.data)==null?void 0:m.error)||"Failed to delete category")}},onCancel:()=>f({open:!1})})},v=async a=>{var x,m;a.preventDefault();try{await k.post(`/admin/categories/${d.data.categoryId}/subcategories`,{name:d.data.name,description:d.data.description}),p({open:!1,data:{}}),G("Subcategory created successfully!"),s()}catch(j){F(((m=(x=j.response)==null?void 0:x.data)==null?void 0:m.error)||"Failed to create subcategory")}},C=async a=>{f({open:!0,title:"Delete Subcategory",message:"Are you sure you want to delete this subcategory? This action cannot be undone.",onConfirm:async()=>{var x,m;f({open:!1});try{await k.delete(`/admin/subcategories/${a}`),G("Subcategory deleted successfully!"),s()}catch(j){F(((m=(x=j.response)==null?void 0:x.data)==null?void 0:m.error)||"Failed to delete subcategory")}},onCancel:()=>f({open:!1})})};return e.jsxs("div",{children:[e.jsx(be,{...c}),e.jsxs("div",{className:"admin-page-header",style:{display:"flex",justifyContent:"space-between",marginBottom:"24px"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600"},children:"Category Management"}),e.jsx(E,{icon:Ce,onClick:()=>{n({open:!0,data:{}}),h(null)},children:"Add Category"})]}),i.open&&ce.createPortal(e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:()=>{n({open:!1,data:{}}),h(null)},children:e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"500px",width:"90%",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h3",{style:{fontSize:"20px",fontWeight:"600",margin:0},children:w?"Edit Category":"Create Category"}),e.jsx("button",{onClick:()=>{n({open:!1,data:{}}),h(null)},style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(_,{size:20})})]}),e.jsxs("form",{onSubmit:w?l:g,children:[e.jsx(J,{label:"Category Name",value:i.data.name||"",onChange:a=>n({...i,data:{...i.data,name:a.target.value}}),required:!0}),e.jsx(J,{label:"Description (Optional)",value:i.data.description||"",onChange:a=>n({...i,data:{...i.data,description:a.target.value}})}),e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[e.jsx(E,{variant:"outline",icon:_,onClick:()=>{n({open:!1,data:{}}),h(null)},children:"Cancel"}),e.jsx(E,{type:"submit",icon:pe,children:w?"Update":"Create"})]})]})]})}),document.body),d.open&&ce.createPortal(e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:()=>{p({open:!1,data:{}})},children:e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"500px",width:"90%",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h3",{style:{fontSize:"20px",fontWeight:"600",margin:0},children:"Add Subcategory"}),e.jsx("button",{onClick:()=>{p({open:!1,data:{}})},style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(_,{size:20})})]}),e.jsxs("form",{onSubmit:v,children:[e.jsx(J,{label:"Subcategory Name",value:d.data.name||"",onChange:a=>p({...d,data:{...d.data,name:a.target.value}}),required:!0}),e.jsx(J,{label:"Description (Optional)",value:d.data.description||"",onChange:a=>p({...d,data:{...d.data,description:a.target.value}})}),e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[e.jsx(E,{variant:"outline",icon:_,onClick:()=>{p({open:!1,data:{}})},children:"Cancel"}),e.jsx(E,{type:"submit",icon:pe,children:"Create"})]})]})]})}),document.body),e.jsx("div",{className:"admin-cards-grid",style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:o.map(a=>e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"16px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",gap:"12px",alignItems:"center"},children:[e.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",background:"#10b981",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px"},children:e.jsx(Me,{size:40,color:"white"})}),e.jsxs("div",{style:{textAlign:"center",marginBottom:"8px"},children:[e.jsx("div",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"2px"},children:a.name}),a.description&&e.jsx("div",{style:{fontSize:"12px",color:"#64748b",lineHeight:"1.4"},children:a.description})]}),a.subCategories&&a.subCategories.length>0&&e.jsx("div",{style:{marginBottom:"8px"},children:e.jsxs("span",{style:{fontSize:"11px",padding:"4px 12px",borderRadius:"12px",background:"#eff6ff",color:"#2563eb",fontWeight:"600"},children:[a.subCategories.length," Subcategor",a.subCategories.length===1?"y":"ies"]})}),a.subCategories&&a.subCategories.length>0&&e.jsx("div",{style:{width:"100%",marginBottom:"8px",maxHeight:"120px",overflowY:"auto",padding:"8px",background:"#f8fafc",borderRadius:"8px"},children:a.subCategories.map(x=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 8px",marginBottom:"4px",background:"white",borderRadius:"6px",fontSize:"12px"},children:[e.jsx("span",{style:{fontWeight:"500",color:"#1e293b"},children:x.name}),e.jsx("button",{onClick:()=>C(x.id),style:{background:"none",border:"none",color:"#ef4444",cursor:"pointer",padding:"2px 6px",fontSize:"12px",borderRadius:"4px"},onMouseOver:m=>{m.target.style.background="#fee2e2"},onMouseOut:m=>{m.target.style.background="transparent"},children:e.jsx(ke,{size:12})})]},x.id))}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",marginTop:"auto",width:"100%"},children:[e.jsx(E,{variant:"outline",icon:Ce,onClick:()=>{p({open:!0,data:{categoryId:a.id,name:"",description:""}})},style:{fontSize:"12px",padding:"6px 12px",width:"100%"},children:"Add Subcategory"}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsxs("button",{onClick:()=>{h(a),n({open:!0,data:{name:a.name,description:a.description||""}})},style:{fontSize:"12px",padding:"6px 12px",border:"none",background:"transparent",color:"#2563eb",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",fontWeight:"500",borderRadius:"6px",transition:"all 0.2s",width:"50%"},onMouseOver:x=>{x.target.style.background="#eff6ff"},onMouseOut:x=>{x.target.style.background="transparent"},children:[e.jsx(Re,{size:14}),"Edit"]}),e.jsx(E,{variant:"danger",icon:ke,onClick:()=>b(a.id),style:{fontSize:"12px",padding:"6px 12px",width:"50%"},children:"Delete"})]})]})]},a.id))})]})}function Jt({reports:o,filters:s,setFilters:i,staff:n,categories:d,showFilters:p,setShowFilters:w,onRefresh:h}){const[c,f]=r.useState(s),[g,l]=r.useState(!1),[b,v]=r.useState(!1),[C,a]=r.useState(!1),x=r.useRef(null),m=r.useRef(null),j=r.useRef(null);r.useEffect(()=>{p&&f(s)},[p]),r.useEffect(()=>{const t=u=>{x.current&&!x.current.contains(u.target)&&l(!1),m.current&&!m.current.contains(u.target)&&v(!1),j.current&&!j.current.contains(u.target)&&a(!1)};return(g||b||C)&&document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[g,b,C]);const A=["REGULAR","SENIOR_CITIZEN","PWD","PREGNANT"],U=Array.from({length:24},(t,u)=>u),H=()=>{const t=new Date().toISOString().split("T")[0],u={startDate:t,endDate:t,staffIds:[],categoryIds:[],clientTypes:[],startHour:"",endHour:""};i(u),f(u)},V=()=>{i(c),w(!1)},T=()=>{f(s),w(!1)},D=s.staffIds.length>0||s.categoryIds.length>0||s.clientTypes.length>0||s.startHour||s.endHour;if(!o)return e.jsx(ne,{});const q=o.byCategory?Object.entries(o.byCategory).map(([t,u])=>({name:t,value:u})):[],M=o.byClientType?Object.entries(o.byClientType).map(([t,u])=>({name:t,value:u})):[],K=o.byStaff?Object.entries(o.byStaff).map(([t,u])=>({name:t,value:u})):[],S=o.byHour?Object.entries(o.byHour).sort((t,u)=>parseInt(t[0])-parseInt(u[0])).map(([t,u])=>({hour:`${t}:00`,value:u})):[];return e.jsxs("div",{children:[e.jsxs("div",{className:"admin-page-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600"},children:"Reports & Analytics"}),e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[D&&e.jsxs("button",{onClick:H,style:{fontSize:"14px",padding:"8px 16px",border:"none",background:"transparent",boxShadow:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",color:"#64748b",fontWeight:"500"},onMouseOver:t=>{t.target.style.color="#1e293b"},onMouseOut:t=>{t.target.style.color="#64748b"},children:[e.jsx(_,{size:16}),"Clear Filters"]}),e.jsxs("button",{onClick:()=>w(!0),style:{fontSize:"14px",padding:"8px 16px",border:"none",background:"transparent",boxShadow:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",color:D?"#2563eb":"#64748b",fontWeight:"500"},onMouseOver:t=>{t.target.style.color="#2563eb"},onMouseOut:t=>{t.target.style.color=D?"#2563eb":"#64748b"},children:[e.jsx(vt,{size:16}),"Filters"]})]})]}),p&&ce.createPortal(e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:T,children:e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"800px",width:"90%",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h3",{style:{fontSize:"20px",fontWeight:"600",margin:0},children:"Filter Reports"}),e.jsx("button",{onClick:T,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(_,{size:20})})]}),e.jsxs("div",{className:"admin-filter-grid",style:{display:"flex",flexDirection:"column",gap:"20px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 2fr",gap:"20px",alignItems:"end"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Start Date"}),e.jsx("input",{type:"date",value:c.startDate,onChange:t=>f({...c,startDate:t.target.value}),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"End Date"}),e.jsx("input",{type:"date",value:c.endDate,onChange:t=>f({...c,endDate:t.target.value}),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px"}})]}),e.jsxs("div",{style:{position:"relative"},ref:x,children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Staff"}),e.jsx("div",{onClick:()=>l(!g),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px",backgroundColor:"white",cursor:"pointer",minHeight:"44px",display:"flex",alignItems:"center",flexWrap:"wrap",gap:"6px"},children:c.staffIds&&c.staffIds.length>0?c.staffIds.map(t=>{const u=n.find(I=>I.id===t);return u?e.jsxs("span",{style:{fontSize:"12px",padding:"4px 8px",borderRadius:"6px",background:"#eff6ff",color:"#2563eb",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},onClick:I=>{I.stopPropagation(),f({...c,staffIds:c.staffIds.filter(z=>z!==t)})},children:[u.name,e.jsx(_,{size:12})]},t):null}):e.jsx("span",{style:{color:"#94a3b8"},children:"Select staff..."})}),g&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"white",border:"2px solid #e2e8f0",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:n.map(t=>{var I;const u=((I=c.staffIds)==null?void 0:I.includes(t.id))||!1;return e.jsxs("div",{onClick:()=>{const z=c.staffIds||[];f(u?{...c,staffIds:z.filter(B=>B!==t.id)}:{...c,staffIds:[...z,t.id]})},style:{padding:"10px 12px",cursor:"pointer",background:u?"#eff6ff":"white",color:u?"#2563eb":"#1e293b",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid #f1f5f9"},onMouseOver:z=>{u||(z.currentTarget.style.background="#f8fafc")},onMouseOut:z=>{u||(z.currentTarget.style.background="white")},children:[e.jsx("input",{type:"checkbox",checked:u,onChange:()=>{},style:{cursor:"pointer"}}),e.jsx("span",{children:t.name})]},t.id)})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",alignItems:"end"},children:[e.jsxs("div",{style:{position:"relative"},ref:m,children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Categories"}),e.jsx("div",{onClick:()=>v(!b),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px",backgroundColor:"white",cursor:"pointer",minHeight:"44px",display:"flex",alignItems:"center",flexWrap:"wrap",gap:"6px"},children:c.categoryIds&&c.categoryIds.length>0?c.categoryIds.map(t=>{const u=d.find(I=>I.id===t);return u?e.jsxs("span",{style:{fontSize:"12px",padding:"4px 8px",borderRadius:"6px",background:"#eff6ff",color:"#2563eb",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},onClick:I=>{I.stopPropagation(),f({...c,categoryIds:c.categoryIds.filter(z=>z!==t)})},children:[u.name,e.jsx(_,{size:12})]},t):null}):e.jsx("span",{style:{color:"#94a3b8"},children:"Select categories..."})}),b&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"white",border:"2px solid #e2e8f0",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:d.map(t=>{var I;const u=((I=c.categoryIds)==null?void 0:I.includes(t.id))||!1;return e.jsxs("div",{onClick:()=>{const z=c.categoryIds||[];f(u?{...c,categoryIds:z.filter(B=>B!==t.id)}:{...c,categoryIds:[...z,t.id]})},style:{padding:"10px 12px",cursor:"pointer",background:u?"#eff6ff":"white",color:u?"#2563eb":"#1e293b",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid #f1f5f9"},onMouseOver:z=>{u||(z.currentTarget.style.background="#f8fafc")},onMouseOut:z=>{u||(z.currentTarget.style.background="white")},children:[e.jsx("input",{type:"checkbox",checked:u,onChange:()=>{},style:{cursor:"pointer"}}),e.jsx("span",{children:t.name})]},t.id)})})]}),e.jsxs("div",{style:{position:"relative"},ref:j,children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Client Types"}),e.jsx("div",{onClick:()=>a(!C),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px",backgroundColor:"white",cursor:"pointer",minHeight:"44px",display:"flex",alignItems:"center",flexWrap:"wrap",gap:"6px"},children:c.clientTypes&&c.clientTypes.length>0?c.clientTypes.map(t=>e.jsxs("span",{style:{fontSize:"12px",padding:"4px 8px",borderRadius:"6px",background:"#eff6ff",color:"#2563eb",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},onClick:u=>{u.stopPropagation(),f({...c,clientTypes:c.clientTypes.filter(I=>I!==t)})},children:[t.replace("_"," "),e.jsx(_,{size:12})]},t)):e.jsx("span",{style:{color:"#94a3b8"},children:"Select client types..."})}),C&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"white",border:"2px solid #e2e8f0",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:A.map(t=>{var I;const u=((I=c.clientTypes)==null?void 0:I.includes(t))||!1;return e.jsxs("div",{onClick:()=>{const z=c.clientTypes||[];f(u?{...c,clientTypes:z.filter(B=>B!==t)}:{...c,clientTypes:[...z,t]})},style:{padding:"10px 12px",cursor:"pointer",background:u?"#eff6ff":"white",color:u?"#2563eb":"#1e293b",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid #f1f5f9"},onMouseOver:z=>{u||(z.currentTarget.style.background="#f8fafc")},onMouseOut:z=>{u||(z.currentTarget.style.background="white")},children:[e.jsx("input",{type:"checkbox",checked:u,onChange:()=>{},style:{cursor:"pointer"}}),e.jsx("span",{children:t.replace("_"," ")})]},t)})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",alignItems:"end"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Start Hour (Peak Hours)"}),e.jsxs(ze,{value:c.startHour,onChange:t=>f({...c,startHour:t.target.value}),children:[e.jsx("option",{value:"",children:"All Hours"}),U.map(t=>e.jsxs("option",{value:t,children:[String(t).padStart(2,"0"),":00"]},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"End Hour (Peak Hours)"}),e.jsxs(ze,{value:c.endHour,onChange:t=>f({...c,endHour:t.target.value}),children:[e.jsx("option",{value:"",children:"All Hours"}),U.map(t=>e.jsxs("option",{value:t,children:[String(t).padStart(2,"0"),":00"]},t))]})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end",marginTop:"24px",paddingTop:"24px",borderTop:"1px solid #e2e8f0"},children:[e.jsx(E,{variant:"outline",icon:_,onClick:T,children:"Cancel"}),e.jsx(E,{variant:"primary",icon:pe,onClick:V,children:"Apply Filters"})]})]})}),document.body),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px"},children:[e.jsx(Z,{label:"Total Served",value:o.totalServed}),e.jsx(Z,{label:"Average Duration",value:`${Math.floor((o.averageDuration||0)/60)}m ${(o.averageDuration||0)%60}s`})]}),e.jsxs("div",{className:"admin-reports-grid",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"24px",marginBottom:"24px"},children:[q.length>0&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h3",{style:{marginBottom:"16px"},children:"By Category"}),e.jsx(se,{width:"100%",height:300,children:e.jsxs(Ie,{data:q,children:[e.jsx(ge,{strokeDasharray:"3 3"}),e.jsx(fe,{dataKey:"name"}),e.jsx(he,{}),e.jsx(ie,{}),e.jsx(Te,{dataKey:"value",fill:"#2563eb"})]})})]}),M.length>0&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h3",{style:{marginBottom:"16px"},children:"By Client Type"}),e.jsx(se,{width:"100%",height:300,children:e.jsxs(Ue,{children:[e.jsx(He,{data:M,cx:"50%",cy:"50%",labelLine:!1,label:({name:t,percent:u})=>`${t}: ${(u*100).toFixed(0)}%`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:M.map((t,u)=>e.jsx(qe,{fill:Fe[u%Fe.length]},`cell-${u}`))}),e.jsx(ie,{})]})})]})]}),S.length>0&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",marginBottom:"24px"},children:[e.jsx("h3",{style:{marginBottom:"16px"},children:"Peak Hours"}),e.jsx(se,{width:"100%",height:300,children:e.jsxs(It,{data:S,children:[e.jsx(ge,{strokeDasharray:"3 3"}),e.jsx(fe,{dataKey:"hour"}),e.jsx(he,{}),e.jsx(ie,{}),e.jsx(Tt,{type:"monotone",dataKey:"value",stroke:"#2563eb",strokeWidth:2})]})})]}),K.length>0&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h3",{style:{marginBottom:"16px"},children:"By Staff"}),e.jsx(se,{width:"100%",height:300,children:e.jsxs(Ie,{data:K,children:[e.jsx(ge,{strokeDasharray:"3 3"}),e.jsx(fe,{dataKey:"name"}),e.jsx(he,{}),e.jsx(ie,{}),e.jsx(Te,{dataKey:"value",fill:"#10b981"})]})})]})]})}function Qt(){const[o,s]=r.useState(null),[i,n]=r.useState(null),[d,p]=r.useState(null),[w,h]=r.useState(!0),[c,f]=r.useState(!1),[g,l]=r.useState({open:!1}),[b,v]=r.useState(null),[C,a]=r.useState(null),[x,m]=r.useState(!1),[j,A]=r.useState({open:!1}),[U,H]=r.useState([{id:"",name:""},{id:"",name:""},{id:"",name:""}]),[V,T]=r.useState(""),[D,q]=r.useState(!1),[M,K]=r.useState(""),[S,t]=r.useState(!1),[u,I]=r.useState(""),[z,B]=r.useState(!1),[O,$]=r.useState("branding");r.useEffect(()=>{R(),Y(),L(),X(),je()},[]);const R=async()=>{try{const y=await k.get("/admin/settings/logo");y.data.logoUrl&&p(y.data.logoUrl)}catch(y){console.error("Failed to load logo:",y)}finally{h(!1)}},Y=async()=>{try{const y=await k.get("/admin/settings/ding-sound");y.data.dingSoundUrl&&a(y.data.dingSoundUrl)}catch(y){console.error("Failed to load ding sound:",y)}},L=async()=>{var y;try{const W=await k.get("/admin/settings/tts-voices"),P=Array.isArray(W.data.voices)?W.data.voices:[],N=[...P];for(;N.length<3;)N.push({id:"",name:""});H(N.slice(0,3)),W.data.activeVoiceId?T(W.data.activeVoiceId):(y=P[0])!=null&&y.id&&T(P[0].id)}catch(W){console.error("Failed to load TTS voices:",W)}},X=async()=>{try{const y=await k.get("/admin/settings/tts-announcement");y.data.template&&K(y.data.template)}catch(y){console.error("Failed to load TTS announcement template:",y)}},je=async()=>{try{const y=await k.get("/admin/settings/video-folder");y.data.videoFolderPath&&I(y.data.videoFolderPath)}catch(y){console.error("Failed to load video folder path:",y)}},ve=y=>{const W=y.target.files[0];if(W){s(W);const P=new FileReader;P.onloadend=()=>{n(P.result)},P.readAsDataURL(W)}},Ae=async y=>{var W,P;if(y.preventDefault(),!!o){f(!0);try{const N=new FormData;N.append("logo",o);const Q=await k.post("/admin/settings/logo",N,{headers:{"Content-Type":"multipart/form-data"}});p(Q.data.logoUrl),s(null),n(null),G("Logo uploaded successfully!")}catch(N){console.error("Failed to upload logo:",N),F(((P=(W=N.response)==null?void 0:W.data)==null?void 0:P.error)||"Failed to upload logo")}finally{f(!1)}}},we=async()=>{l({open:!0,title:"Delete Logo",message:"Are you sure you want to delete the current logo?",onConfirm:async()=>{var y,W;l({open:!1});try{await k.delete("/admin/settings/logo"),p(null),s(null),n(null),G("Logo deleted successfully!")}catch(P){console.error("Failed to delete logo:",P),F(((W=(y=P.response)==null?void 0:y.data)==null?void 0:W.error)||"Failed to delete logo")}},onCancel:()=>l({open:!1})})},Je=y=>{const W=y.target.files[0];W&&v(W)},Qe=async y=>{var W,P;if(y.preventDefault(),!!b){m(!0);try{const N=new FormData;N.append("sound",b);const Q=await k.post("/admin/settings/ding-sound",N,{headers:{"Content-Type":"multipart/form-data"}});a(Q.data.dingSoundUrl),v(null),G("Ding sound uploaded successfully!")}catch(N){console.error("Failed to upload ding sound:",N),F(((P=(W=N.response)==null?void 0:W.data)==null?void 0:P.error)||"Failed to upload ding sound")}finally{m(!1)}}},Ke=async()=>{A({open:!0,title:"Delete Ding Sound",message:"Are you sure you want to delete the current ding sound?",onConfirm:async()=>{var y,W;A({open:!1});try{await k.delete("/admin/settings/ding-sound"),a(null),v(null),G("Ding sound deleted successfully!")}catch(P){console.error("Failed to delete ding sound:",P),F(((W=(y=P.response)==null?void 0:y.data)==null?void 0:W.error)||"Failed to delete ding sound")}},onCancel:()=>A({open:!1})})},Xe=async y=>{var W,P;if(y.preventDefault(),!u.trim()){F("Video folder path cannot be empty");return}B(!0);try{await k.post("/admin/settings/video-folder",{videoFolderPath:u.trim()}),G("Video folder path updated successfully!")}catch(N){console.error("Failed to save video folder path:",N),F(((P=(W=N.response)==null?void 0:W.data)==null?void 0:P.error)||"Failed to save video folder path")}finally{B(!1)}},Ze=async y=>{const W=typeof y=="string"?y.trim():"";if(!W){F("Please enter a voice ID first");return}const P="Window 1 will now serve number 123, or John Doe.";try{const Q=(await k.post("/tts",{text:P,voiceId:W},{responseType:"arraybuffer"})).data;if(!Q)return;const le=new Blob([Q],{type:"audio/mpeg"}),Se=URL.createObjectURL(le);new Audio(Se).play().catch(ae=>{console.error("Failed to play preview TTS audio:",ae)}).finally(()=>{URL.revokeObjectURL(Se)})}catch(N){console.error("Failed to preview TTS voice:",N),F("Failed to preview this voice. Please check your ElevenLabs settings.")}},Pe=(y,W,P)=>{H(N=>{const Q=[...N];return Q[y]={...Q[y],[W]:P},Q})},et=async y=>{var W,P;y.preventDefault(),q(!0);try{const N=U.map(ae=>({id:(ae.id||"").trim(),name:(ae.name||"").trim()})).filter(ae=>ae.id);if(N.length===0){F("Please enter at least one ElevenLabs voice ID"),q(!1);return}const Q=V&&N.some(ae=>ae.id===V)?V:N[0].id,le=await k.post("/admin/settings/tts-voices",{voices:N,activeVoiceId:Q}),ue=[...Array.isArray(le.data.voices)?le.data.voices:N];for(;ue.length<3;)ue.push({id:"",name:""});H(ue.slice(0,3)),T(le.data.activeVoiceId||Q),G("TTS voices updated successfully!")}catch(N){console.error("Failed to save TTS voices:",N),F(((P=(W=N.response)==null?void 0:W.data)==null?void 0:P.error)||"Failed to save TTS voices")}finally{q(!1)}},tt=async y=>{var P,N;y.preventDefault();const W=(M||"").trim();if(!W){F("Announcement template cannot be empty");return}t(!0);try{await k.post("/admin/settings/tts-announcement",{template:W}),G("Announcement template updated successfully!")}catch(Q){console.error("Failed to save announcement template:",Q),F(((N=(P=Q.response)==null?void 0:P.data)==null?void 0:N.error)||"Failed to save announcement template")}finally{t(!1)}};return w?e.jsx(ne,{}):e.jsxs("div",{children:[e.jsx(be,{...g}),e.jsx(be,{...j}),e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"16px"},children:"Settings"}),e.jsx("div",{style:{display:"flex",gap:"8px",marginBottom:"24px",borderBottom:"1px solid #e2e8f0",paddingBottom:"4px",overflowX:"auto"},children:[{id:"branding",label:"Branding"},{id:"audio",label:"Audio & TTS"},{id:"videos",label:"Videos"}].map(y=>{const W=O===y.id;return e.jsx("button",{type:"button",onClick:()=>$(y.id),style:{padding:"8px 16px",borderRadius:"9999px",border:"none",backgroundColor:W?"#1d4ed8":"transparent",color:W?"#ffffff":"#475569",fontSize:"14px",fontWeight:W?600:500,cursor:"pointer",boxShadow:W?"0 1px 3px rgba(15, 23, 42, 0.25)":"none",whiteSpace:"nowrap"},children:y.label},y.id)})}),O==="branding"&&e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderTop:"3px solid #2563eb"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Logo"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"24px"},children:"Upload a logo to display across all pages. Supported formats: JPG, PNG, GIF, SVG, WebP (max 5MB)"}),d&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Current Logo:"}),e.jsx("img",{src:d,alt:"Current logo",style:{maxWidth:"200px",maxHeight:"100px",objectFit:"contain",border:"1px solid #e2e8f0",borderRadius:"8px",padding:"8px"}})]}),e.jsxs("form",{onSubmit:Ae,children:[e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"Upload New Logo"}),e.jsx("input",{type:"file",accept:"image/*",onChange:ve,style:{width:"100%",padding:"8px",border:"2px solid #e2e8f0",borderRadius:"8px",fontSize:"14px"}})]}),i&&e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Preview:"}),e.jsx("img",{src:i,alt:"Preview",style:{maxWidth:"200px",maxHeight:"100px",objectFit:"contain",border:"1px solid #e2e8f0",borderRadius:"8px",padding:"8px"}})]}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx(E,{type:"submit",disabled:!o||c,children:c?"Uploading...":"Upload Logo"}),d&&e.jsx(E,{variant:"danger",onClick:we,children:"Delete Logo"})]})]})]})}),O==="audio"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderTop:"3px solid #f97316"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Ding Sound (Announcement Chime)"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"24px"},children:"Upload a short audio file to play before each queue announcement on the public monitoring page. Supported formats: MP3, WAV, OGG, M4A, AAC (max 2MB). Keep it brief (under 2 seconds) for best results."}),C&&e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Current Ding Sound:"}),e.jsx("audio",{controls:!0,src:C,style:{width:"100%",maxWidth:"400px"},children:"Your browser does not support the audio element."})]}),e.jsxs("form",{onSubmit:Qe,children:[e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"Upload New Ding Sound"}),e.jsx("input",{type:"file",accept:"audio/*",onChange:Je,style:{width:"100%",padding:"8px",border:"2px solid #e2e8f0",borderRadius:"8px",fontSize:"14px"}})]}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx(E,{type:"submit",disabled:!b||x,children:x?"Uploading...":"Upload Ding Sound"}),C&&e.jsx(E,{variant:"danger",onClick:Ke,children:"Delete Ding Sound"})]})]})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderTop:"3px solid #0ea5e9"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Announcement Message Template"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"12px"},children:"Control what the voice will say when announcing a new client. You can use the following placeholders, which will be replaced automatically:"}),e.jsxs("ul",{style:{fontSize:"13px",color:"#64748b",marginBottom:"16px",paddingLeft:"20px"},children:[e.jsxs("li",{children:[e.jsx("code",{style:{fontFamily:"monospace"},children:"{{window}}"})," â€” window label (e.g. Window 1)"]}),e.jsxs("li",{children:[e.jsx("code",{style:{fontFamily:"monospace"},children:"{{queueNumber}}"})," â€” queue number counter (e.g. 6)"]}),e.jsxs("li",{children:[e.jsx("code",{style:{fontFamily:"monospace"},children:"{{clientName}}"})," â€” client name (may be empty)"]}),e.jsxs("li",{children:[e.jsx("code",{style:{fontFamily:"monospace"},children:"{{clientNamePart}}"})," â€” expands to ",e.jsx("code",{children:", or client name John Doe"})," when a name exists, or nothing otherwise"]})]}),e.jsxs("form",{onSubmit:tt,children:[e.jsx("textarea",{value:M,onChange:y=>K(y.target.value),rows:3,style:{width:"100%",padding:"12px 14px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px",fontFamily:"monospace",resize:"vertical",boxSizing:"border-box"},placeholder:"Window {{window}} will now serve queue number {{queueNumber}}{{clientNamePart}}."}),e.jsx("div",{style:{marginTop:"12px",display:"flex",gap:"8px"},children:e.jsx(E,{type:"submit",disabled:S,children:S?"Saving Template...":"Save Template"})})]})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderTop:"3px solid #10b981"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Text-to-Speech Voices (ElevenLabs)"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"16px"},children:"Configure up to three ElevenLabs voice IDs and choose which one is active for queue announcements. Voice IDs can be copied from your ElevenLabs dashboard."}),e.jsxs("form",{onSubmit:et,children:[U.map((y,W)=>e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(0, 1.2fr) minmax(0, 1.4fr) auto",gap:"12px",marginBottom:"12px",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",marginBottom:"4px",fontSize:"13px",fontWeight:"500"},children:["Voice ",W+1," Name (optional)"]}),e.jsx("input",{type:"text",value:y.name||"",onChange:P=>Pe(W,"name",P.target.value),placeholder:"e.g. Front Desk Female",style:{width:"100%",padding:"8px 10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",marginBottom:"4px",fontSize:"13px",fontWeight:"500"},children:["Voice ",W+1," ID"]}),e.jsx("input",{type:"text",value:y.id||"",onChange:P=>Pe(W,"id",P.target.value),placeholder:"ElevenLabs voice ID",style:{width:"100%",padding:"8px 10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px",fontFamily:"monospace"}})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"6px"},children:[e.jsx("button",{type:"button",onClick:()=>Ze(y.id),disabled:!y.id,style:{padding:"6px 10px",borderRadius:"6px",border:"1px solid #e2e8f0",backgroundColor:y.id?"#eff6ff":"#f8fafc",color:y.id?"#2563eb":"#94a3b8",fontSize:"12px",fontWeight:500,cursor:y.id?"pointer":"not-allowed"},children:"Preview Voice"}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"13px"},children:[e.jsx("input",{type:"radio",name:"activeVoice",checked:!!y.id&&V===y.id,disabled:!y.id,onChange:()=>{y.id&&T(y.id)}}),"Active"]})]})]},W)),e.jsx("div",{style:{marginTop:"16px",display:"flex",gap:"8px"},children:e.jsx(E,{type:"submit",disabled:D,children:D?"Saving Voices...":"Save Voices"})})]})]})]}),O==="videos"&&e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderTop:"3px solid #6366f1"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Video Folder Path"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"24px"},children:"Configure the local folder path where video files are stored. The system will scan this folder for video files (mp4, webm, ogg, mov, avi) to play on the public monitoring page."}),e.jsxs("form",{onSubmit:Xe,children:[e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"Video Folder Path"}),e.jsx("input",{type:"text",value:u,onChange:y=>I(y.target.value),placeholder:"C:\\\\Users\\\\username\\\\videos or /Users/username/videos or videos",style:{width:"100%",padding:"12px 16px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px",fontFamily:"monospace",backgroundColor:"#f8fafc",color:"#1e293b",transition:"all 0.2s",boxSizing:"border-box"},onFocus:y=>{y.target.style.borderColor="#2563eb",y.target.style.backgroundColor="#ffffff",y.target.style.boxShadow="0 0 0 3px rgba(37, 99, 235, 0.1)"},onBlur:y=>{y.target.style.borderColor="#e2e8f0",y.target.style.backgroundColor="#f8fafc",y.target.style.boxShadow="none"}}),e.jsxs("p",{style:{fontSize:"12px",color:"#64748b",marginTop:"8px",marginBottom:0},children:["Enter an absolute path (Windows: ",e.jsx("code",{style:{fontFamily:"monospace",fontSize:"11px",background:"#f1f5f9",padding:"2px 4px",borderRadius:"4px"},children:"C:\\Users\\username\\videos"})," or Mac/Linux: ",e.jsx("code",{style:{fontFamily:"monospace",fontSize:"11px",background:"#f1f5f9",padding:"2px 4px",borderRadius:"4px"},children:"/Users/username/videos"}),") or a relative path from the backend directory (e.g., ",e.jsx("code",{style:{fontFamily:"monospace",fontSize:"11px",background:"#f1f5f9",padding:"2px 4px",borderRadius:"4px"},children:"videos"}),")"]})]}),e.jsx("div",{style:{display:"flex",gap:"8px"},children:e.jsx(E,{type:"submit",disabled:z||!u.trim(),children:z?"Saving...":"Save Video Folder Path"})})]})]})})]})}function Kt(){return e.jsxs(e.Fragment,{children:[e.jsx(Ft,{}),e.jsxs(wt,{children:[e.jsx(ee,{path:"/",element:e.jsx(Rt,{})}),e.jsx(ee,{path:"/success",element:e.jsx(Bt,{})}),e.jsx(ee,{path:"/thank-you",element:e.jsx(At,{})}),e.jsx(ee,{path:"/monitor",element:e.jsx(Pt,{})}),e.jsx(ee,{path:"/staff/login",element:e.jsx(Et,{})}),e.jsx(ee,{path:"/staff/dashboard",element:e.jsx(Lt,{})}),e.jsx(ee,{path:"/staff/profile",element:e.jsx(Mt,{})}),e.jsx(ee,{path:"/admin/login",element:e.jsx(Ut,{})}),e.jsx(ee,{path:"/admin/dashboard",element:e.jsx(Vt,{})})]})]})}St.createRoot(document.getElementById("root")).render(e.jsx(Ct.StrictMode,{children:e.jsx(kt,{children:e.jsx(Kt,{})})}));
